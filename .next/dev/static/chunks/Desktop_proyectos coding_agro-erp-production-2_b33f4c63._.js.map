{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/percyscastillo/Desktop/proyectos%20coding/agro-erp-production-2/src/modules/crm/services/crmConfig.js"],"sourcesContent":["export const DEFAULT_STAGES = [\n  { code: \"prospeccion\", name: \"Prospección\", order: 1, probability: 0.10, color: \"slate\" },\n  { code: \"contacto\", name: \"Contacto\", order: 2, probability: 0.20, color: \"blue\" },\n  { code: \"visita\", name: \"Visita Finca\", order: 3, probability: 0.35, color: \"cyan\" },\n  { code: \"demo\", name: \"Demostración\", order: 4, probability: 0.50, color: \"indigo\" },\n  { code: \"cotizacion\", name: \"Cotización\", order: 5, probability: 0.70, color: \"purple\" },\n  { code: \"negociacion\", name: \"Negociación\", order: 6, probability: 0.85, color: \"amber\" },\n  { code: \"ganado\", name: \"Ganado\", order: 7, probability: 1.00, color: \"emerald\" },\n  { code: \"perdido\", name: \"Perdido\", order: 8, probability: 0.00, color: \"red\" },\n];\n\nexport const STAGE_COLORS = {\n  slate: { bg: \"bg-slate-100\", border: \"border-slate-300\", text: \"text-slate-700\", header: \"bg-slate-200\" },\n  blue: { bg: \"bg-blue-50\", border: \"border-blue-300\", text: \"text-blue-700\", header: \"bg-blue-200\" },\n  cyan: { bg: \"bg-cyan-50\", border: \"border-cyan-300\", text: \"text-cyan-700\", header: \"bg-cyan-200\" },\n  indigo: { bg: \"bg-indigo-50\", border: \"border-indigo-300\", text: \"text-indigo-700\", header: \"bg-indigo-200\" },\n  purple: { bg: \"bg-purple-50\", border: \"border-purple-300\", text: \"text-purple-700\", header: \"bg-purple-200\" },\n  amber: { bg: \"bg-amber-50\", border: \"border-amber-300\", text: \"text-amber-700\", header: \"bg-amber-200\" },\n  emerald: { bg: \"bg-emerald-50\", border: \"border-emerald-300\", text: \"text-emerald-700\", header: \"bg-emerald-200\" },\n  red: { bg: \"bg-red-50\", border: \"border-red-300\", text: \"text-red-700\", header: \"bg-red-200\" },\n};\n\nexport const ACTIVITY_TYPES = [\n  { code: \"llamada\", name: \"Llamada\", icon: \"phone\" },\n  { code: \"visita\", name: \"Visita\", icon: \"car\" },\n  { code: \"whatsapp\", name: \"WhatsApp\", icon: \"message\" },\n  { code: \"email\", name: \"Email\", icon: \"mail\" },\n  { code: \"demo\", name: \"Demo Campo\", icon: \"leaf\" },\n];\n\nexport const OPPORTUNITY_SOURCES = [\n  \"Referido\",\n  \"Visita finca\",\n  \"WhatsApp\",\n  \"Llamada entrante\",\n  \"Feria agrícola\",\n  \"Web\",\n  \"Otro\",\n];\n\nexport function getStageColor(colorName) {\n  return STAGE_COLORS[colorName] || STAGE_COLORS.slate;\n}\n\nexport function calculatePipelineValue(opportunities, stages) {\n  return opportunities.reduce((total, opp) => {\n    const stage = stages.find((s) => s.id === opp.stage_id);\n    const probability = stage?.probability || 0;\n    return total + (opp.amount || 0) * probability;\n  }, 0);\n}\n\nexport function groupOpportunitiesByStage(opportunities, stages) {\n  const grouped = {};\n  stages.forEach((stage) => {\n    grouped[stage.id] = {\n      stage,\n      opportunities: [],\n      totalAmount: 0,\n      count: 0,\n    };\n  });\n\n  opportunities.forEach((opp) => {\n    if (grouped[opp.stage_id]) {\n      grouped[opp.stage_id].opportunities.push(opp);\n      grouped[opp.stage_id].totalAmount += opp.amount || 0;\n      grouped[opp.stage_id].count += 1;\n    }\n  });\n\n  return Object.values(grouped).sort((a, b) => a.stage.sort_order - b.stage.sort_order);\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 200, "column": 0}, "map": {"version":3,"sources":["file:///Users/percyscastillo/Desktop/proyectos%20coding/agro-erp-production-2/src/modules/crm/hooks/useCrm.js"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState, useMemo, useCallback } from \"react\";\nimport {\n  groupOpportunitiesByStage,\n  calculatePipelineValue,\n} from \"../services/crmConfig\";\n\nexport function useCrm(orgSlug) {\n  /* ===========================================================\n     ESTADOS PRINCIPALES\n  =========================================================== */\n  const [stages, setStages] = useState([]);\n  const [opportunities, setOpportunities] = useState([]);\n  const [activities, setActivities] = useState([]);\n  const [clients, setClients] = useState([]);\n\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  /* ===========================================================\n     FILTROS\n  =========================================================== */\n  const [search, setSearch] = useState(\"\");\n  const [stageFilter, setStageFilter] = useState(\"TODOS\");\n  const [statusFilter, setStatusFilter] = useState(\"open\");\n\n  /* ===========================================================\n     MODALES\n  =========================================================== */\n  const [isOpportunityModalOpen, setIsOpportunityModalOpen] = useState(false);\n  const [editingOpportunity, setEditingOpportunity] = useState(null);\n\n  const [isActivityModalOpen, setIsActivityModalOpen] = useState(false);\n  const [selectedOpportunityForActivity, setSelectedOpportunityForActivity] =\n    useState(null);\n\n  const [isClientModalOpen, setIsClientModalOpen] = useState(false);\n  const [editingClient, setEditingClient] = useState(null);\n\n  /* ===========================================================\n     RECARGA PRINCIPAL DEL CRM\n  =========================================================== */\n  const loadCrm = useCallback(async () => {\n    try {\n      setLoading(true);\n      setError(null);\n\n      const res = await fetch(`/api/crm?orgSlug=${orgSlug}`, {\n        method: \"GET\",\n      });\n\n      const json = await res.json();\n      if (!json.success) throw new Error(json.error || \"Error al cargar CRM\");\n\n      setStages(json.data.stages || []);\n      setOpportunities(json.data.opportunities || []);\n      setActivities(json.data.activities || []);\n      setClients(json.data.clients || []);\n    } catch (err) {\n      console.error(\"CRM Load Error:\", err);\n      setError(err.message);\n    } finally {\n      setLoading(false);\n    }\n  }, [orgSlug]);\n\n  useEffect(() => {\n    loadCrm();\n  }, [loadCrm]);\n\n  /* ===========================================================\n     COMPUTADOS (PIPELINE + AGRUPACIÓN)\n  =========================================================== */\n\n  // Agrupar oportunidades por etapa\n  const groupedOpportunities = useMemo(() => {\n    return groupOpportunitiesByStage(opportunities, stages);\n  }, [opportunities, stages]);\n\n  // Valor total del pipeline\n  const pipelineValue = useMemo(() => {\n    return calculatePipelineValue(opportunities);\n  }, [opportunities]);\n\n  /* ===========================================================\n     FILTRO INTELIGENTE DE OPORTUNIDADES\n  =========================================================== */\n  const filteredOpportunities = useMemo(() => {\n    let list = [...opportunities];\n\n    // filtro por texto (cliente, nombre, teléfono)\n    if (search.trim() !== \"\") {\n      const q = search.toLowerCase();\n      list = list.filter((op) => {\n        const clientName =\n          `${op.client?.first_name || \"\"} ${op.client?.last_name || \"\"}`.toLowerCase();\n        return (\n          op.title?.toLowerCase().includes(q) ||\n          clientName.includes(q) ||\n          op.client?.phone?.includes(q)\n        );\n      });\n    }\n\n    // filtrar por etapa\n    if (stageFilter !== \"TODOS\") {\n      list = list.filter((op) => op.stage_id === stageFilter);\n    }\n\n    // filtrar por estado\n    if (statusFilter === \"open\") {\n      list = list.filter((op) => !op.is_won && !op.is_lost);\n    } else if (statusFilter === \"won\") {\n      list = list.filter((op) => op.is_won);\n    } else if (statusFilter === \"lost\") {\n      list = list.filter((op) => op.is_lost);\n    }\n\n    return list;\n  }, [opportunities, search, stageFilter, statusFilter]);\n\n  /* ===========================================================\n     FUNCIONES PARA MODALES\n  =========================================================== */\n\n  const openNewOpportunityModal = () => {\n    setEditingOpportunity(null);\n    setIsOpportunityModalOpen(true);\n  };\n\n  const openEditOpportunityModal = (op) => {\n    setEditingOpportunity(op);\n    setIsOpportunityModalOpen(true);\n  };\n\n  const openNewActivityModal = (opportunity) => {\n    setSelectedOpportunityForActivity(opportunity);\n    setIsActivityModalOpen(true);\n  };\n\n  const openEditClientModal = (client) => {\n    setEditingClient(client);\n    setIsClientModalOpen(true);\n  };\n\n  const closeAllModals = () => {\n    setIsOpportunityModalOpen(false);\n    setIsActivityModalOpen(false);\n    setIsClientModalOpen(false);\n\n    setEditingOpportunity(null);\n    setSelectedOpportunityForActivity(null);\n    setEditingClient(null);\n  };\n\n  /* ===========================================================\n     RETORNO COMPLETO\n  =========================================================== */\n  return {\n    // estados\n    loading,\n    error,\n\n    stages,\n    opportunities,\n    activities,\n    clients,\n\n    // computados\n    groupedOpportunities,\n    pipelineValue,\n    filteredOpportunities,\n\n    // filtros\n    search,\n    setSearch,\n    stageFilter,\n    setStageFilter,\n    statusFilter,\n    setStatusFilter,\n\n    // modales\n    isOpportunityModalOpen,\n    setIsOpportunityModalOpen,\n    editingOpportunity,\n    setEditingOpportunity,\n\n    isActivityModalOpen,\n    setIsActivityModalOpen,\n    selectedOpportunityForActivity,\n    setSelectedOpportunityForActivity,\n\n    isClientModalOpen,\n    setIsClientModalOpen,\n    editingClient,\n    setEditingClient,\n\n    // funciones\n    openNewOpportunityModal,\n    openEditOpportunityModal,\n    openNewActivityModal,\n    openEditClientModal,\n    closeAllModals,\n    reload: loadCrm,\n  };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 407, "column": 0}, "map": {"version":3,"sources":["file:///Users/percyscastillo/Desktop/proyectos%20coding/agro-erp-production-2/src/modules/crm/components/CrmStats.js"],"sourcesContent":["\"use client\";\n\nimport React from \"react\";\n\nexport default function CrmStats({ stats }) {\n  const {\n    totalOpportunities = 0,\n    totalPipelineValue = 0,\n    conversionRate = 0,\n    closingThisWeek = 0,\n  } = stats || {};\n\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n      <div className=\"bg-white border rounded-xl p-4 shadow-sm\">\n        <p className=\"text-xs text-slate-500 uppercase tracking-wide\">\n          Oportunidades Abiertas\n        </p>\n        <p className=\"text-2xl font-bold text-slate-800 mt-1\">\n          {totalOpportunities}\n        </p>\n        <p className=\"text-xs text-slate-400 mt-1\">en pipeline</p>\n      </div>\n\n      <div className=\"bg-white border rounded-xl p-4 shadow-sm\">\n        <p className=\"text-xs text-slate-500 uppercase tracking-wide\">\n          Valor Total Pipeline\n        </p>\n        <p className=\"text-2xl font-bold text-emerald-600 mt-1\">\n          C$ {totalPipelineValue.toLocaleString(\"es-NI\")}\n        </p>\n        <p className=\"text-xs text-slate-400 mt-1\">potencial de ventas</p>\n      </div>\n\n      <div className=\"bg-white border rounded-xl p-4 shadow-sm\">\n        <p className=\"text-xs text-slate-500 uppercase tracking-wide\">\n          Tasa de Cierre\n        </p>\n        <p className=\"text-2xl font-bold text-indigo-600 mt-1\">\n          {conversionRate}%\n        </p>\n        <p className=\"text-xs text-slate-400 mt-1\">últimos 30 días</p>\n      </div>\n\n      <div className=\"bg-white border rounded-xl p-4 shadow-sm\">\n        <p className=\"text-xs text-slate-500 uppercase tracking-wide\">\n          Próximos Cierres\n        </p>\n        <p className=\"text-2xl font-bold text-amber-600 mt-1\">\n          {closingThisWeek}\n        </p>\n        <p className=\"text-xs text-slate-400 mt-1\">esta semana</p>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAIe,SAAS,SAAS,EAAE,KAAK,EAAE;IACxC,MAAM,EACJ,qBAAqB,CAAC,EACtB,qBAAqB,CAAC,EACtB,iBAAiB,CAAC,EAClB,kBAAkB,CAAC,EACpB,GAAG,SAAS,CAAC;IAEd,qBACE,+PAAC;QAAI,WAAU;;0BACb,+PAAC;gBAAI,WAAU;;kCACb,+PAAC;wBAAE,WAAU;kCAAiD;;;;;;kCAG9D,+PAAC;wBAAE,WAAU;kCACV;;;;;;kCAEH,+PAAC;wBAAE,WAAU;kCAA8B;;;;;;;;;;;;0BAG7C,+PAAC;gBAAI,WAAU;;kCACb,+PAAC;wBAAE,WAAU;kCAAiD;;;;;;kCAG9D,+PAAC;wBAAE,WAAU;;4BAA2C;4BAClD,mBAAmB,cAAc,CAAC;;;;;;;kCAExC,+PAAC;wBAAE,WAAU;kCAA8B;;;;;;;;;;;;0BAG7C,+PAAC;gBAAI,WAAU;;kCACb,+PAAC;wBAAE,WAAU;kCAAiD;;;;;;kCAG9D,+PAAC;wBAAE,WAAU;;4BACV;4BAAe;;;;;;;kCAElB,+PAAC;wBAAE,WAAU;kCAA8B;;;;;;;;;;;;0BAG7C,+PAAC;gBAAI,WAAU;;kCACb,+PAAC;wBAAE,WAAU;kCAAiD;;;;;;kCAG9D,+PAAC;wBAAE,WAAU;kCACV;;;;;;kCAEH,+PAAC;wBAAE,WAAU;kCAA8B;;;;;;;;;;;;;;;;;;AAInD;KAnDwB"}},
    {"offset": {"line": 576, "column": 0}, "map": {"version":3,"sources":["file:///Users/percyscastillo/Desktop/proyectos%20coding/agro-erp-production-2/src/modules/crm/components/CrmFilters.jsx"],"sourcesContent":["\"use client\";\n\nimport React from \"react\";\n\nexport default function CrmFilters({\n  search,\n  setSearch,\n  stageFilter,\n  setStageFilter,\n  stages,\n}) {\n  return (\n    <div className=\"flex flex-wrap gap-3 items-center\">\n      <input\n        type=\"text\"\n        placeholder=\"Buscar por nombre o cliente...\"\n        value={search}\n        onChange={(e) => setSearch(e.target.value)}\n        className=\"px-3 py-2 border rounded-lg text-sm w-64 focus:outline-none focus:ring-2 focus:ring-slate-200\"\n      />\n\n      <select\n        value={stageFilter}\n        onChange={(e) => setStageFilter(e.target.value)}\n        className=\"px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-slate-200\"\n      >\n        <option value=\"TODOS\">Todas las etapas</option>\n        {stages.map((stage) => (\n          <option key={stage.id} value={stage.id}>\n            {stage.name}\n          </option>\n        ))}\n      </select>\n    </div>\n  );\n}\n\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAIe,SAAS,WAAW,EACjC,MAAM,EACN,SAAS,EACT,WAAW,EACX,cAAc,EACd,MAAM,EACP;IACC,qBACE,+PAAC;QAAI,WAAU;;0BACb,+PAAC;gBACC,MAAK;gBACL,aAAY;gBACZ,OAAO;gBACP,UAAU,CAAC,IAAM,UAAU,EAAE,MAAM,CAAC,KAAK;gBACzC,WAAU;;;;;;0BAGZ,+PAAC;gBACC,OAAO;gBACP,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,KAAK;gBAC9C,WAAU;;kCAEV,+PAAC;wBAAO,OAAM;kCAAQ;;;;;;oBACrB,OAAO,GAAG,CAAC,CAAC,sBACX,+PAAC;4BAAsB,OAAO,MAAM,EAAE;sCACnC,MAAM,IAAI;2BADA,MAAM,EAAE;;;;;;;;;;;;;;;;;AAO/B;KA/BwB"}},
    {"offset": {"line": 644, "column": 0}, "map": {"version":3,"sources":["file:///Users/percyscastillo/Desktop/proyectos%20coding/agro-erp-production-2/src/modules/crm/components/OpportunityCard.jsx"],"sourcesContent":["\"use client\";\n\nimport React from \"react\";\nimport {\n  PencilIcon,\n  TrashIcon,\n  ChatBubbleOvalLeftIcon,\n  CheckCircleIcon,\n  XCircleIcon,\n} from \"@heroicons/react/24/outline\";\n\nexport default function OpportunityCard({\n  opportunity,\n  stageColor,\n  onEdit,\n  onDelete,\n  onAddActivity,\n  onMarkWon,\n  onMarkLost,\n  onDragStart,\n  onDragEnd,\n  isDragging,\n}) {\n  const probability = opportunity.stage_probability || 0;\n\n  return (\n    <div\n      draggable\n      onDragStart={onDragStart}\n      onDragEnd={onDragEnd}\n      className={`\n        bg-white rounded-xl border shadow-[0_2px_6px_rgba(0,0,0,0.06)]\n        p-3 cursor-grab transition-all select-none\n        hover:shadow-[0_4px_12px_rgba(0,0,0,0.12)]\n        active:cursor-grabbing\n        ${isDragging ? \"opacity-40 scale-[0.98]\" : \"opacity-100\"}\n      `}\n    >\n      {/* BARRA LATERAL DE COLOR */}\n      <div\n        className=\"w-1 h-full absolute left-0 top-0 rounded-l-xl\"\n        style={{ backgroundColor: stageColor }}\n      />\n\n      {/* TITULO + MONTO */}\n      <div className=\"flex justify-between items-start mb-1\">\n        <h3 className=\"font-semibold text-sm text-slate-800 leading-tight\">\n          {opportunity.title}\n        </h3>\n\n        <span className=\"text-xs font-bold bg-blue-50 text-blue-600 px-2 py-1 rounded-full\">\n          C${Number(opportunity.amount).toLocaleString(\"es-NI\")}\n        </span>\n      </div>\n\n      {/* CLIENTE */}\n      <p className=\"text-xs text-slate-500 mb-2\">\n        {opportunity.client_name || \"— Sin cliente —\"}\n      </p>\n\n      {/* PROBABILIDAD Y PROGRESO */}\n      <div className=\"mb-2\">\n        <div className=\"flex justify-between text-[11px] text-slate-500 font-medium mb-1\">\n          <span>Probabilidad</span>\n          <span>{probability}%</span>\n        </div>\n\n        <div className=\"w-full h-2 bg-slate-200 rounded-full overflow-hidden\">\n          <div\n            className=\"h-full rounded-full transition-all\"\n            style={{\n              width: `${probability}%`,\n              backgroundColor: stageColor,\n            }}\n          />\n        </div>\n      </div>\n\n      {/* BOTONES DE ACCIONES */}\n      <div className=\"flex justify-between items-center mt-3\">\n\n        {/* ACTIVIDADES */}\n        <button\n          onClick={onAddActivity}\n          className=\"text-xs text-slate-500 hover:text-blue-600 flex items-center gap-1\"\n        >\n          <ChatBubbleOvalLeftIcon className=\"h-4 w-4\" />\n          Actividad\n        </button>\n\n        {/* ACCIONES DERECHA */}\n        <div className=\"flex items-center gap-2\">\n\n          <button\n            className=\"p-1 hover:bg-slate-100 rounded\"\n            onClick={onEdit}\n          >\n            <PencilIcon className=\"h-4 w-4 text-slate-600\" />\n          </button>\n\n          <button\n            className=\"p-1 hover:bg-slate-100 rounded\"\n            onClick={onDelete}\n          >\n            <TrashIcon className=\"h-4 w-4 text-red-500\" />\n          </button>\n\n          {/* GANAR */}\n          {onMarkWon && (\n            <button\n              className=\"p-1 hover:bg-green-50 rounded\"\n              onClick={onMarkWon}\n            >\n              <CheckCircleIcon className=\"h-5 w-5 text-green-600\" />\n            </button>\n          )}\n\n          {/* PERDER */}\n          {onMarkLost && (\n            <button\n              className=\"p-1 hover:bg-red-50 rounded\"\n              onClick={onMarkLost}\n            >\n              <XCircleIcon className=\"h-5 w-5 text-red-600\" />\n            </button>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAHA;;;;AAWe,SAAS,gBAAgB,EACtC,WAAW,EACX,UAAU,EACV,MAAM,EACN,QAAQ,EACR,aAAa,EACb,SAAS,EACT,UAAU,EACV,WAAW,EACX,SAAS,EACT,UAAU,EACX;IACC,MAAM,cAAc,YAAY,iBAAiB,IAAI;IAErD,qBACE,+PAAC;QACC,SAAS;QACT,aAAa;QACb,WAAW;QACX,WAAW,CAAC;;;;;QAKV,EAAE,aAAa,4BAA4B,cAAc;MAC3D,CAAC;;0BAGD,+PAAC;gBACC,WAAU;gBACV,OAAO;oBAAE,iBAAiB;gBAAW;;;;;;0BAIvC,+PAAC;gBAAI,WAAU;;kCACb,+PAAC;wBAAG,WAAU;kCACX,YAAY,KAAK;;;;;;kCAGpB,+PAAC;wBAAK,WAAU;;4BAAoE;4BAC/E,OAAO,YAAY,MAAM,EAAE,cAAc,CAAC;;;;;;;;;;;;;0BAKjD,+PAAC;gBAAE,WAAU;0BACV,YAAY,WAAW,IAAI;;;;;;0BAI9B,+PAAC;gBAAI,WAAU;;kCACb,+PAAC;wBAAI,WAAU;;0CACb,+PAAC;0CAAK;;;;;;0CACN,+PAAC;;oCAAM;oCAAY;;;;;;;;;;;;;kCAGrB,+PAAC;wBAAI,WAAU;kCACb,cAAA,+PAAC;4BACC,WAAU;4BACV,OAAO;gCACL,OAAO,GAAG,YAAY,CAAC,CAAC;gCACxB,iBAAiB;4BACnB;;;;;;;;;;;;;;;;;0BAMN,+PAAC;gBAAI,WAAU;;kCAGb,+PAAC;wBACC,SAAS;wBACT,WAAU;;0CAEV,+PAAC,0UAAsB;gCAAC,WAAU;;;;;;4BAAY;;;;;;;kCAKhD,+PAAC;wBAAI,WAAU;;0CAEb,+PAAC;gCACC,WAAU;gCACV,SAAS;0CAET,cAAA,+PAAC,sSAAU;oCAAC,WAAU;;;;;;;;;;;0CAGxB,+PAAC;gCACC,WAAU;gCACV,SAAS;0CAET,cAAA,+PAAC,mSAAS;oCAAC,WAAU;;;;;;;;;;;4BAItB,2BACC,+PAAC;gCACC,WAAU;gCACV,SAAS;0CAET,cAAA,+PAAC,qTAAe;oCAAC,WAAU;;;;;;;;;;;4BAK9B,4BACC,+PAAC;gCACC,WAAU;gCACV,SAAS;0CAET,cAAA,+PAAC,ySAAW;oCAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOrC;KAvHwB"}},
    {"offset": {"line": 885, "column": 0}, "map": {"version":3,"sources":["file:///Users/percyscastillo/Desktop/proyectos%20coding/agro-erp-production-2/src/modules/crm/components/PipelineBoard.jsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState } from \"react\";\nimport OpportunityCard from \"./OpportunityCard\";\nimport { getStageColor } from \"../services/crmConfig\";\n\nexport default function PipelineBoard({\n  pipelineData,\n  onMoveOpportunity,\n  onEditOpportunity,\n  onDeleteOpportunity,\n  onAddActivity,\n  onMarkWon,\n  onMarkLost,\n}) {\n  const [draggedOpportunity, setDraggedOpportunity] = useState(null);\n  const [dragOverStage, setDragOverStage] = useState(null);\n\n  /* ============================================================\n     DRAG & DROP HANDLERS\n  ============================================================ */\n  const handleDragStart = (e, opportunity) => {\n    setDraggedOpportunity(opportunity);\n    e.dataTransfer.effectAllowed = \"move\";\n    e.dataTransfer.setData(\"text/plain\", opportunity.id);\n  };\n\n  const handleDragEnd = () => {\n    setDraggedOpportunity(null);\n    setDragOverStage(null);\n  };\n\n  const handleDragOver = (e, stageId) => {\n    e.preventDefault();\n    e.dataTransfer.dropEffect = \"move\";\n    setDragOverStage(stageId);\n  };\n\n  const handleDrop = async (e, targetStageId) => {\n    e.preventDefault();\n    setDragOverStage(null);\n\n    if (draggedOpportunity && draggedOpportunity.stage_id !== targetStageId) {\n      await onMoveOpportunity(draggedOpportunity.id, targetStageId);\n    }\n\n    setDraggedOpportunity(null);\n  };\n\n  /* ============================================================\n     UI\n  ============================================================ */\n  if (!pipelineData || pipelineData.length === 0) {\n    return (\n      <div className=\"text-center py-8 text-slate-400\">\n        No hay etapas configuradas. Crea las etapas en Supabase primero.\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"overflow-x-auto pb-4\">\n      {/* CONTENEDOR TIPO MONDAY — COLUMNAS CON SEPARACIÓN GRANDE */}\n      <div className=\"flex gap-6 min-w-max px-2\">\n\n        {pipelineData.map(({ stage, opportunities, totalAmount, count }) => {\n          const colors = getStageColor(stage.color);\n          const isDropTarget = dragOverStage === stage.id;\n\n          return (\n            <div\n              key={stage.id}\n              /* CARD DE COLUMNA — ESTILO MONDAY */\n              className={`\n                w-80 flex-shrink-0 rounded-2xl\n                bg-white shadow-[0_3px_8px_rgba(0,0,0,0.07)]\n                border border-slate-100\n                flex flex-col transition-all\n                ${isDropTarget ? \"ring-2 ring-blue-400 ring-offset-2 scale-[1.01]\" : \"\"}\n              `}\n              onDragOver={(e) => handleDragOver(e, stage.id)}\n              onDrop={(e) => handleDrop(e, stage.id)}\n            >\n\n              {/* HEADER ESTILO MONDAY */}\n              <div className=\"px-4 py-3 border-b border-slate-200 bg-slate-50 rounded-t-2xl\">\n                <div className=\"flex justify-between items-center\">\n                  <h3 className=\"font-semibold text-slate-700 text-sm\">\n                    {stage.name}\n                  </h3>\n\n                  <span\n                    className=\"text-xs font-semibold px-2 py-1 rounded-full bg-slate-200 text-slate-700\"\n                  >\n                    {count}\n                  </span>\n                </div>\n\n                <p className=\"text-xs text-slate-500 mt-1 font-medium\">\n                  Total: C${totalAmount.toLocaleString(\"es-NI\")}\n                </p>\n              </div>\n\n              {/* OPORTUNIDADES */}\n              <div className=\"p-3 space-y-3 min-h-[260px] max-h-[600px] overflow-y-auto\">\n\n                {opportunities.length === 0 && (\n                  <div className=\"text-center py-10 text-xs text-slate-400 italic\">\n                    {isDropTarget ? \"Soltar aquí…\" : \"Sin oportunidades\"}\n                  </div>\n                )}\n\n                {/* RENDER CARDS — ESTILO MONDAY */}\n                {opportunities.map((opp) => (\n                  <div\n                    key={opp.id}\n                    draggable\n                    onDragStart={(e) => handleDragStart(e, opp)}\n                    onDragEnd={handleDragEnd}\n                    className={`transition-all duration-200 ${\n                      draggedOpportunity?.id === opp.id ? \"opacity-40\" : \"opacity-100\"\n                    }`}\n                  >\n                    <OpportunityCard\n                      opportunity={opp}\n                      stageColor={stage.color}\n                      onEdit={() => onEditOpportunity(opp)}\n                      onDelete={() => {\n                        if (confirm(\"¿Eliminar esta oportunidad?\")) onDeleteOpportunity(opp.id);\n                      }}\n                      onAddActivity={() => onAddActivity(opp)}\n                      onMarkWon={() => onMarkWon(opp.id)}\n                      onMarkLost={() => {\n                        const reason = prompt(\"Razón de pérdida:\");\n                        if (reason) onMarkLost(opp.id, reason);\n                      }}\n                    />\n                  </div>\n                ))}\n              </div>\n\n              {/* FOOTER — BOTÓN AÑADIR OPORTUNIDAD */}\n              <div className=\"bg-slate-50 p-3 border-t border-slate-200 rounded-b-2xl\">\n                <button\n                  className=\"w-full py-2 text-xs font-medium rounded-lg bg-white hover:bg-slate-100\n                             border border-slate-300 text-slate-700 transition\"\n                  onClick={() => onEditOpportunity(null, stage.id)}\n                >\n                  + Añadir oportunidad\n                </button>\n              </div>\n\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1092, "column": 0}, "map": {"version":3,"sources":["file:///Users/percyscastillo/Desktop/proyectos%20coding/agro-erp-production-2/src/modules/crm/components/ClientStagesTable.js"],"sourcesContent":["\"use client\";\n\nimport React from \"react\";\nimport { getStageColor } from \"../services/crmConfig\";\n\nexport default function ClientStagesTable({ clientsByStage, stages }) {\n  if (!clientsByStage || clientsByStage.length === 0) {\n    return (\n      <div className=\"text-center py-8 text-slate-400\">\n        No hay clientes con oportunidades activas\n      </div>\n    );\n  }\n\n  const formatDate = (dateStr) => {\n    if (!dateStr) return \"—\";\n    const date = new Date(dateStr);\n    const now = new Date();\n    const diffDays = Math.floor((now - date) / (1000 * 60 * 60 * 24));\n\n    if (diffDays === 0) return \"Hoy\";\n    if (diffDays === 1) return \"Ayer\";\n    if (diffDays < 7) return `Hace ${diffDays} días`;\n    return date.toLocaleDateString(\"es-NI\", { day: \"2-digit\", month: \"short\" });\n  };\n\n  return (\n    <div className=\"overflow-x-auto\">\n      <table className=\"min-w-full text-sm\">\n        <thead>\n          <tr className=\"bg-slate-50 border-b text-xs uppercase tracking-wide text-slate-500\">\n            <th className=\"px-3 py-2 text-left\">Cliente</th>\n            <th className=\"px-3 py-2 text-left\">Teléfono</th>\n            <th className=\"px-3 py-2 text-center\">Etapa Actual</th>\n            <th className=\"px-3 py-2 text-center\">Oportunidades</th>\n            <th className=\"px-3 py-2 text-right\">Valor Total</th>\n            <th className=\"px-3 py-2 text-center\">Último Contacto</th>\n          </tr>\n        </thead>\n        <tbody>\n          {clientsByStage.map((client) => {\n            const colors = getStageColor(client.stage_color);\n\n            return (\n              <tr key={client.client_id} className=\"border-b hover:bg-slate-50\">\n                <td className=\"px-3 py-2\">\n                  <p className=\"font-medium text-slate-800\">{client.client_name}</p>\n                </td>\n                <td className=\"px-3 py-2 text-slate-600\">\n                  {client.client_phone || \"—\"}\n                </td>\n                <td className=\"px-3 py-2 text-center\">\n                  <span\n                    className={`px-3 py-1 rounded-full text-xs font-medium ${colors.bg} ${colors.text}`}\n                  >\n                    {client.stage_name}\n                  </span>\n                </td>\n                <td className=\"px-3 py-2 text-center\">\n                  <span className=\"px-2 py-1 bg-slate-100 rounded-full text-xs\">\n                    {client.opportunityCount}\n                  </span>\n                </td>\n                <td className=\"px-3 py-2 text-right font-medium text-emerald-600\">\n                  C$ {(client.totalAmount || 0).toLocaleString(\"es-NI\")}\n                </td>\n                <td className=\"px-3 py-2 text-center text-slate-500\">\n                  {formatDate(client.lastContact)}\n                </td>\n              </tr>\n            );\n          })}\n        </tbody>\n      </table>\n    </div>\n  );\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAKe,SAAS,kBAAkB,EAAE,cAAc,EAAE,MAAM,EAAE;IAClE,IAAI,CAAC,kBAAkB,eAAe,MAAM,KAAK,GAAG;QAClD,qBACE,+PAAC;YAAI,WAAU;sBAAkC;;;;;;IAIrD;IAEA,MAAM,aAAa,CAAC;QAClB,IAAI,CAAC,SAAS,OAAO;QACrB,MAAM,OAAO,IAAI,KAAK;QACtB,MAAM,MAAM,IAAI;QAChB,MAAM,WAAW,KAAK,KAAK,CAAC,CAAC,MAAM,IAAI,IAAI,CAAC,OAAO,KAAK,KAAK,EAAE;QAE/D,IAAI,aAAa,GAAG,OAAO;QAC3B,IAAI,aAAa,GAAG,OAAO;QAC3B,IAAI,WAAW,GAAG,OAAO,CAAC,KAAK,EAAE,SAAS,KAAK,CAAC;QAChD,OAAO,KAAK,kBAAkB,CAAC,SAAS;YAAE,KAAK;YAAW,OAAO;QAAQ;IAC3E;IAEA,qBACE,+PAAC;QAAI,WAAU;kBACb,cAAA,+PAAC;YAAM,WAAU;;8BACf,+PAAC;8BACC,cAAA,+PAAC;wBAAG,WAAU;;0CACZ,+PAAC;gCAAG,WAAU;0CAAsB;;;;;;0CACpC,+PAAC;gCAAG,WAAU;0CAAsB;;;;;;0CACpC,+PAAC;gCAAG,WAAU;0CAAwB;;;;;;0CACtC,+PAAC;gCAAG,WAAU;0CAAwB;;;;;;0CACtC,+PAAC;gCAAG,WAAU;0CAAuB;;;;;;0CACrC,+PAAC;gCAAG,WAAU;0CAAwB;;;;;;;;;;;;;;;;;8BAG1C,+PAAC;8BACE,eAAe,GAAG,CAAC,CAAC;wBACnB,MAAM,SAAS,IAAA,oOAAa,EAAC,OAAO,WAAW;wBAE/C,qBACE,+PAAC;4BAA0B,WAAU;;8CACnC,+PAAC;oCAAG,WAAU;8CACZ,cAAA,+PAAC;wCAAE,WAAU;kDAA8B,OAAO,WAAW;;;;;;;;;;;8CAE/D,+PAAC;oCAAG,WAAU;8CACX,OAAO,YAAY,IAAI;;;;;;8CAE1B,+PAAC;oCAAG,WAAU;8CACZ,cAAA,+PAAC;wCACC,WAAW,CAAC,2CAA2C,EAAE,OAAO,EAAE,CAAC,CAAC,EAAE,OAAO,IAAI,EAAE;kDAElF,OAAO,UAAU;;;;;;;;;;;8CAGtB,+PAAC;oCAAG,WAAU;8CACZ,cAAA,+PAAC;wCAAK,WAAU;kDACb,OAAO,gBAAgB;;;;;;;;;;;8CAG5B,+PAAC;oCAAG,WAAU;;wCAAoD;wCAC5D,CAAC,OAAO,WAAW,IAAI,CAAC,EAAE,cAAc,CAAC;;;;;;;8CAE/C,+PAAC;oCAAG,WAAU;8CACX,WAAW,OAAO,WAAW;;;;;;;2BAvBzB,OAAO,SAAS;;;;;oBA2B7B;;;;;;;;;;;;;;;;;AAKV;KAvEwB"}},
    {"offset": {"line": 1307, "column": 0}, "map": {"version":3,"sources":["file:///Users/percyscastillo/Desktop/proyectos%20coding/agro-erp-production-2/src/modules/crm/components/OpportunityModal.jsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState, useEffect } from \"react\";\nimport { OPPORTUNITY_SOURCES } from \"../services/crmConfig\";\n\nexport default function OpportunityModal({\n  isOpen,\n  onClose,\n  onSave,\n  opportunity,\n  stages,\n  clients,\n}) {\n  const firstStage = stages?.find((s) => s.sort_order === 1) || stages?.[0];\n\n  const [form, setForm] = useState({\n    title: \"\",\n    client_id: \"\",\n    amount: \"\",\n    stage_id: firstStage?.id || \"\",\n    expected_close_date: \"\",\n    source: \"\",\n    notes: \"\",\n  });\n\n  const [saving, setSaving] = useState(false);\n\n  /* ===========================================\n     LOAD FORM DATA\n  ============================================ */\n  useEffect(() => {\n    if (!isOpen) return;\n\n    if (opportunity) {\n      setForm({\n        title: opportunity.title || \"\",\n        client_id: opportunity.client_id || \"\",\n        amount: opportunity.amount?.toString() || \"\",\n        stage_id: opportunity.stage_id || firstStage?.id || \"\",\n        expected_close_date:\n          opportunity.expected_close_date?.split(\"T\")[0] || \"\",\n        source: opportunity.source || \"\",\n        notes: opportunity.notes || \"\",\n      });\n    } else {\n      setForm({\n        title: \"\",\n        client_id: \"\",\n        amount: \"\",\n        stage_id: firstStage?.id || \"\",\n        expected_close_date: \"\",\n        source: \"\",\n        notes: \"\",\n      });\n    }\n  }, [opportunity, isOpen, stages]);\n\n  if (!isOpen) return null;\n\n  /* ===========================================\n     HANDLE INPUT CHANGE\n  ============================================ */\n  const handleChange = (e) => {\n    const { name, value } = e.target;\n    setForm((prev) => ({ ...prev, [name]: value }));\n  };\n\n  /* ===========================================\n     SUBMIT FORM\n  ============================================ */\n  const handleSubmit = async () => {\n    setSaving(true);\n\n    const safeStage =\n      form.stage_id && form.stage_id !== \"\"\n        ? form.stage_id\n        : firstStage?.id || null;\n\n    const data = {\n      title: form.title.trim(),\n      client_id: form.client_id || null,\n      stage_id: safeStage,\n      amount: Number(form.amount) || 0,\n      expected_close_date: form.expected_close_date || null,\n      source: form.source || null,\n      notes: form.notes || null,\n    };\n\n    if (opportunity?.id) data.id = opportunity.id;\n\n    const result = await onSave(data);\n\n    setSaving(false);\n\n    if (!result.success) {\n      alert(result.error || \"Error al guardar\");\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\n      <div className=\"bg-white rounded-xl shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto\">\n\n        {/* HEADER */}\n        <div className=\"px-6 py-4 border-b flex justify-between items-center\">\n          <h2 className=\"text-lg font-semibold\">\n            {opportunity ? \"Editar Oportunidad\" : \"Nueva Oportunidad\"}\n          </h2>\n          <button\n            onClick={onClose}\n            className=\"text-slate-400 hover:text-slate-600 text-2xl\"\n          >\n            &times;\n          </button>\n        </div>\n\n        {/* FORM */}\n        <div className=\"p-6 space-y-4\">\n\n          {/* TÍTULO */}\n          <div>\n            <label className=\"block text-xs font-medium mb-1\">Título *</label>\n            <input\n              type=\"text\"\n              name=\"title\"\n              value={form.title}\n              onChange={handleChange}\n              required\n              placeholder=\"Ej: Venta alimento - Finca La Esperanza\"\n              className=\"w-full px-3 py-2 border rounded-lg text-sm\"\n            />\n          </div>\n\n          {/* CLIENTE */}\n          <div>\n            <label className=\"block text-xs font-medium mb-1\">Cliente</label>\n            <select\n              name=\"client_id\"\n              value={form.client_id}\n              onChange={handleChange}\n              className=\"w-full px-3 py-2 border rounded-lg text-sm\"\n            >\n              <option value=\"\">Seleccionar cliente...</option>\n              {clients.map((client) => (\n                <option key={client.id} value={client.id}>\n                  {client.first_name} {client.last_name}\n                </option>\n              ))}\n            </select>\n          </div>\n\n          {/* MONTO + ETAPA */}\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div>\n              <label className=\"block text-xs font-medium mb-1\">Monto *</label>\n              <input\n                type=\"number\"\n                name=\"amount\"\n                value={form.amount}\n                onChange={handleChange}\n                required\n                className=\"w-full px-3 py-2 border rounded-lg text-sm\"\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-xs font-medium mb-1\">Etapa *</label>\n              <select\n                name=\"stage_id\"\n                value={form.stage_id}\n                onChange={handleChange}\n                required\n                className=\"w-full px-3 py-2 border rounded-lg text-sm\"\n              >\n                {stages\n                  .filter((s) => s.code !== \"ganado\" && s.code !== \"perdido\")\n                  .map((stage) => (\n                    <option key={stage.id} value={stage.id}>\n                      {stage.name}\n                    </option>\n                  ))}\n              </select>\n            </div>\n          </div>\n\n          {/* NOTAS */}\n          <div>\n            <label className=\"block text-xs font-medium mb-1\">Notas</label>\n            <textarea\n              name=\"notes\"\n              value={form.notes}\n              onChange={handleChange}\n              rows={3}\n              className=\"w-full px-3 py-2 border rounded-lg text-sm\"\n            />\n          </div>\n\n          {/* BOTONES */}\n          <div className=\"flex justify-end gap-2 pt-4 border-t\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"px-4 py-2 text-sm text-slate-600\"\n            >\n              Cancelar\n            </button>\n\n            <button\n              type=\"button\"\n              onClick={handleSubmit}\n              disabled={saving}\n              className=\"px-4 py-2 text-sm bg-slate-900 text-white rounded-lg disabled:opacity-50\"\n            >\n              {saving ? \"Guardando...\" : \"Guardar\"}\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1664, "column": 0}, "map": {"version":3,"sources":["file:///Users/percyscastillo/Desktop/proyectos%20coding/agro-erp-production-2/src/modules/crm/components/ActivityModal.jsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState } from \"react\";\nimport { ACTIVITY_TYPES } from \"../services/crmConfig\";\n\nexport default function ActivityModal({ isOpen, onClose, onSave, opportunity }) {\n  const [form, setForm] = useState({\n    type: \"llamada\",\n    subject: \"\",\n    description: \"\",\n    outcome: \"\",\n    next_step: \"\",\n  });\n  const [saving, setSaving] = useState(false);\n\n  if (!isOpen || !opportunity) return null;\n\n  const handleChange = (e) => {\n    const { name, value } = e.target;\n    setForm((prev) => ({ ...prev, [name]: value }));\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setSaving(true);\n    const data = {\n      ...form,\n      opportunity_id: opportunity.id,\n      client_id: opportunity.client_id,\n      completed_at: new Date().toISOString(),\n    };\n    const result = await onSave(data);\n    setSaving(false);\n    if (result.success) {\n      setForm({ type: \"llamada\", subject: \"\", description: \"\", outcome: \"\", next_step: \"\" });\n    } else {\n      alert(result.error || \"Error al guardar\");\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\n      <div className=\"bg-white rounded-xl shadow-xl w-full max-w-lg\">\n        <div className=\"px-6 py-4 border-b flex justify-between items-center\">\n          <div>\n            <h2 className=\"text-lg font-semibold\">Registrar Actividad</h2>\n            <p className=\"text-sm text-slate-500\">{opportunity.name}</p>\n          </div>\n          <button onClick={onClose} className=\"text-slate-400 hover:text-slate-600 text-2xl\">&times;</button>\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"p-6 space-y-4\">\n          <div>\n            <label className=\"block text-xs font-medium text-slate-600 mb-2\">Tipo de Actividad *</label>\n            <div className=\"flex flex-wrap gap-2\">\n              {ACTIVITY_TYPES.map((actType) => (\n                <button key={actType.code} type=\"button\"\n                  onClick={() => setForm((prev) => ({ ...prev, type: actType.code }))}\n                  className={`px-3 py-2 rounded-lg text-sm border transition-all ${\n                    form.type === actType.code\n                      ? \"bg-slate-900 text-white border-slate-900\"\n                      : \"bg-white text-slate-600 border-slate-200 hover:border-slate-400\"\n                  }`}>\n                  {actType.name}\n                </button>\n              ))}\n            </div>\n          </div>\n\n          <div>\n            <label className=\"block text-xs font-medium text-slate-600 mb-1\">Asunto *</label>\n            <input type=\"text\" name=\"subject\" value={form.subject} onChange={handleChange} required\n              placeholder=\"Ej: Llamada de seguimiento\"\n              className=\"w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-slate-200\" />\n          </div>\n\n          <div>\n            <label className=\"block text-xs font-medium text-slate-600 mb-1\">Descripción</label>\n            <textarea name=\"description\" value={form.description} onChange={handleChange} rows={2}\n              placeholder=\"Detalles de la actividad...\"\n              className=\"w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-slate-200\" />\n          </div>\n\n          <div>\n            <label className=\"block text-xs font-medium text-slate-600 mb-1\">Resultado</label>\n            <input type=\"text\" name=\"outcome\" value={form.outcome} onChange={handleChange}\n              placeholder=\"Ej: Cliente interesado, solicitó cotización\"\n              className=\"w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-slate-200\" />\n          </div>\n\n          <div>\n            <label className=\"block text-xs font-medium text-slate-600 mb-1\">Próximo Paso</label>\n            <input type=\"text\" name=\"next_step\" value={form.next_step} onChange={handleChange}\n              placeholder=\"Ej: Enviar cotización el lunes\"\n              className=\"w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-slate-200\" />\n          </div>\n\n          <div className=\"flex justify-end gap-2 pt-4 border-t\">\n            <button type=\"button\" onClick={onClose} className=\"px-4 py-2 text-sm text-slate-600 hover:text-slate-800\">Cancelar</button>\n            <button type=\"submit\" disabled={saving}\n              className=\"px-4 py-2 text-sm bg-slate-900 text-white rounded-lg hover:bg-slate-800 disabled:opacity-50\">\n              {saving ? \"Guardando...\" : \"Guardar Actividad\"}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1975, "column": 0}, "map": {"version":3,"sources":["file:///Users/percyscastillo/Desktop/proyectos%20coding/agro-erp-production-2/src/modules/crm/components/SalesFunnel.jsx"],"sourcesContent":["\"use client\";\n\nimport React from \"react\";\nimport { getStageColor } from \"../services/crmConfig\";\n\nexport default function SalesFunnel({ pipelineData }) {\n  if (!pipelineData || pipelineData.length === 0) {\n    return (\n      <div className=\"text-center py-8 text-slate-400\">\n        No hay datos para mostrar el embudo\n      </div>\n    );\n  }\n\n  const maxCount = Math.max(...pipelineData.map((d) => d.count), 1);\n  const totalValue = pipelineData.reduce((sum, d) => sum + d.totalAmount, 0);\n  const totalCount = pipelineData.reduce((sum, d) => sum + d.count, 0);\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"grid grid-cols-2 gap-4 mb-6\">\n        <div className=\"bg-slate-50 rounded-lg p-4 text-center\">\n          <p className=\"text-3xl font-bold text-slate-800\">{totalCount}</p>\n          <p className=\"text-xs text-slate-500\">Oportunidades totales</p>\n        </div>\n        <div className=\"bg-emerald-50 rounded-lg p-4 text-center\">\n          <p className=\"text-3xl font-bold text-emerald-600\">\n            C$ {totalValue.toLocaleString(\"es-NI\")}\n          </p>\n          <p className=\"text-xs text-emerald-600\">Valor total pipeline</p>\n        </div>\n      </div>\n\n      <div className=\"space-y-3\">\n        {pipelineData.map(({ stage, count, totalAmount }) => {\n          const colors = getStageColor(stage.color);\n          const widthPercent = Math.max((count / maxCount) * 100, 5);\n          const conversionRate = totalCount > 0 ? Math.round((count / totalCount) * 100) : 0;\n\n          return (\n            <div key={stage.id} className=\"relative\">\n              <div className=\"flex items-center gap-4\">\n                <div className=\"w-32 text-right\">\n                  <p className={`text-sm font-medium ${colors.text}`}>\n                    {stage.name}\n                  </p>\n                  <p className=\"text-xs text-slate-400\">\n                    {Math.round(stage.probability * 100)}% prob.\n                  </p>\n                </div>\n\n                <div className=\"flex-1 relative\">\n                  <div className=\"h-10 bg-slate-100 rounded-lg overflow-hidden\">\n                    <div\n                      className={`h-full ${colors.header} transition-all duration-500 flex items-center justify-end pr-3`}\n                      style={{ width: `${widthPercent}%` }}\n                    >\n                      {widthPercent > 20 && (\n                        <span className={`text-xs font-medium ${colors.text}`}>\n                          {count} ({conversionRate}%)\n                        </span>\n                      )}\n                    </div>\n                  </div>\n                  {widthPercent <= 20 && (\n                    <span className=\"absolute right-2 top-1/2 -translate-y-1/2 text-xs text-slate-500\">\n                      {count} ({conversionRate}%)\n                    </span>\n                  )}\n                </div>\n\n                <div className=\"w-32 text-right\">\n                  <p className=\"text-sm font-semibold text-emerald-600\">\n                    C$ {totalAmount.toLocaleString(\"es-NI\")}\n                  </p>\n                  <p className=\"text-xs text-slate-400\">\n                    Ponderado: C$ {Math.round(totalAmount * stage.probability).toLocaleString(\"es-NI\")}\n                  </p>\n                </div>\n              </div>\n            </div>\n          );\n        })}\n      </div>\n\n      <div className=\"mt-6 p-4 bg-indigo-50 rounded-lg\">\n        <h4 className=\"text-sm font-semibold text-indigo-700 mb-2\">\n          Valor Ponderado del Pipeline\n        </h4>\n        <p className=\"text-2xl font-bold text-indigo-600\">\n          C$ {pipelineData.reduce((sum, d) => sum + (d.totalAmount * d.stage.probability), 0).toLocaleString(\"es-NI\")}\n        </p>\n        <p className=\"text-xs text-indigo-500 mt-1\">\n          Basado en la probabilidad de cierre de cada etapa\n        </p>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAKe,SAAS,YAAY,EAAE,YAAY,EAAE;IAClD,IAAI,CAAC,gBAAgB,aAAa,MAAM,KAAK,GAAG;QAC9C,qBACE,+PAAC;YAAI,WAAU;sBAAkC;;;;;;IAIrD;IAEA,MAAM,WAAW,KAAK,GAAG,IAAI,aAAa,GAAG,CAAC,CAAC,IAAM,EAAE,KAAK,GAAG;IAC/D,MAAM,aAAa,aAAa,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,EAAE,WAAW,EAAE;IACxE,MAAM,aAAa,aAAa,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,EAAE,KAAK,EAAE;IAElE,qBACE,+PAAC;QAAI,WAAU;;0BACb,+PAAC;gBAAI,WAAU;;kCACb,+PAAC;wBAAI,WAAU;;0CACb,+PAAC;gCAAE,WAAU;0CAAqC;;;;;;0CAClD,+PAAC;gCAAE,WAAU;0CAAyB;;;;;;;;;;;;kCAExC,+PAAC;wBAAI,WAAU;;0CACb,+PAAC;gCAAE,WAAU;;oCAAsC;oCAC7C,WAAW,cAAc,CAAC;;;;;;;0CAEhC,+PAAC;gCAAE,WAAU;0CAA2B;;;;;;;;;;;;;;;;;;0BAI5C,+PAAC;gBAAI,WAAU;0BACZ,aAAa,GAAG,CAAC,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,WAAW,EAAE;oBAC9C,MAAM,SAAS,IAAA,oOAAa,EAAC,MAAM,KAAK;oBACxC,MAAM,eAAe,KAAK,GAAG,CAAC,AAAC,QAAQ,WAAY,KAAK;oBACxD,MAAM,iBAAiB,aAAa,IAAI,KAAK,KAAK,CAAC,AAAC,QAAQ,aAAc,OAAO;oBAEjF,qBACE,+PAAC;wBAAmB,WAAU;kCAC5B,cAAA,+PAAC;4BAAI,WAAU;;8CACb,+PAAC;oCAAI,WAAU;;sDACb,+PAAC;4CAAE,WAAW,CAAC,oBAAoB,EAAE,OAAO,IAAI,EAAE;sDAC/C,MAAM,IAAI;;;;;;sDAEb,+PAAC;4CAAE,WAAU;;gDACV,KAAK,KAAK,CAAC,MAAM,WAAW,GAAG;gDAAK;;;;;;;;;;;;;8CAIzC,+PAAC;oCAAI,WAAU;;sDACb,+PAAC;4CAAI,WAAU;sDACb,cAAA,+PAAC;gDACC,WAAW,CAAC,OAAO,EAAE,OAAO,MAAM,CAAC,+DAA+D,CAAC;gDACnG,OAAO;oDAAE,OAAO,GAAG,aAAa,CAAC,CAAC;gDAAC;0DAElC,eAAe,oBACd,+PAAC;oDAAK,WAAW,CAAC,oBAAoB,EAAE,OAAO,IAAI,EAAE;;wDAClD;wDAAM;wDAAG;wDAAe;;;;;;;;;;;;;;;;;wCAKhC,gBAAgB,oBACf,+PAAC;4CAAK,WAAU;;gDACb;gDAAM;gDAAG;gDAAe;;;;;;;;;;;;;8CAK/B,+PAAC;oCAAI,WAAU;;sDACb,+PAAC;4CAAE,WAAU;;gDAAyC;gDAChD,YAAY,cAAc,CAAC;;;;;;;sDAEjC,+PAAC;4CAAE,WAAU;;gDAAyB;gDACrB,KAAK,KAAK,CAAC,cAAc,MAAM,WAAW,EAAE,cAAc,CAAC;;;;;;;;;;;;;;;;;;;uBApCxE,MAAM,EAAE;;;;;gBA0CtB;;;;;;0BAGF,+PAAC;gBAAI,WAAU;;kCACb,+PAAC;wBAAG,WAAU;kCAA6C;;;;;;kCAG3D,+PAAC;wBAAE,WAAU;;4BAAqC;4BAC5C,aAAa,MAAM,CAAC,CAAC,KAAK,IAAM,MAAO,EAAE,WAAW,GAAG,EAAE,KAAK,CAAC,WAAW,EAAG,GAAG,cAAc,CAAC;;;;;;;kCAErG,+PAAC;wBAAE,WAAU;kCAA+B;;;;;;;;;;;;;;;;;;AAMpD;KA7FwB"}},
    {"offset": {"line": 2257, "column": 0}, "map": {"version":3,"sources":["file:///Users/percyscastillo/Desktop/proyectos%20coding/agro-erp-production-2/src/modules/crm/components/ClientModal.jsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState, useEffect } from \"react\";\n\nexport default function ClientModal({ isOpen, onClose, onSave, client }) {\n  const [form, setForm] = useState({\n    first_name: \"\",\n    last_name: \"\",\n    phone: \"\",\n    address: \"\",\n    city: \"\",\n    municipio: \"\",\n    animal_type: \"\",\n    sales_stage: \"prospecto\",\n  });\n  const [saving, setSaving] = useState(false);\n\n  useEffect(() => {\n    if (client) {\n      setForm({\n        first_name: client.first_name || \"\",\n        last_name: client.last_name || \"\",\n        phone: client.phone || \"\",\n        address: client.address || \"\",\n        city: client.city || \"\",\n        municipio: client.municipio || \"\",\n        animal_type: client.animal_type || \"\",\n        sales_stage: client.sales_stage || \"prospecto\",\n      });\n    } else {\n      setForm({\n        first_name: \"\",\n        last_name: \"\",\n        phone: \"\",\n        address: \"\",\n        city: \"\",\n        municipio: \"\",\n        animal_type: \"\",\n        sales_stage: \"prospecto\",\n      });\n    }\n  }, [client, isOpen]);\n\n  if (!isOpen) return null;\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    if (!form.first_name.trim()) {\n      alert(\"El nombre es requerido\");\n      return;\n    }\n    setSaving(true);\n    try {\n      await onSave(client ? { ...form, id: client.id } : form);\n      onClose();\n    } catch (err) {\n      alert(\"Error: \" + err.message);\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const animalTypes = [\"Bovino\", \"Porcino\", \"Avícola\", \"Equino\", \"Caprino\", \"Ovino\", \"Otro\"];\n  const salesStages = [\n    { value: \"prospecto\", label: \"Prospecto\" },\n    { value: \"contacto\", label: \"Contacto Inicial\" },\n    { value: \"visita\", label: \"Visita Programada\" },\n    { value: \"cotizacion\", label: \"Cotización Enviada\" },\n    { value: \"negociacion\", label: \"En Negociación\" },\n    { value: \"cliente\", label: \"Cliente Activo\" },\n  ];\n\n  return (\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\" onClick={onClose}>\n      <div className=\"bg-white rounded-xl w-full max-w-lg m-4\" onClick={(e) => e.stopPropagation()}>\n        <div className=\"p-4 border-b flex justify-between items-center\">\n          <h2 className=\"font-bold text-lg\">{client ? \"Editar Cliente\" : \"Nuevo Cliente\"}</h2>\n          <button onClick={onClose} className=\"text-slate-400 hover:text-slate-600 text-2xl\">&times;</button>\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"p-4 space-y-4\">\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div>\n              <label className=\"text-xs font-medium text-slate-600\">Nombre *</label>\n              <input\n                type=\"text\"\n                value={form.first_name}\n                onChange={(e) => setForm({ ...form, first_name: e.target.value })}\n                className=\"w-full p-2 text-sm border rounded-lg\"\n                placeholder=\"Nombre\"\n                required\n              />\n            </div>\n            <div>\n              <label className=\"text-xs font-medium text-slate-600\">Apellido</label>\n              <input\n                type=\"text\"\n                value={form.last_name}\n                onChange={(e) => setForm({ ...form, last_name: e.target.value })}\n                className=\"w-full p-2 text-sm border rounded-lg\"\n                placeholder=\"Apellido\"\n              />\n            </div>\n          </div>\n\n          <div>\n            <label className=\"text-xs font-medium text-slate-600\">Teléfono</label>\n            <input\n              type=\"tel\"\n              value={form.phone}\n              onChange={(e) => setForm({ ...form, phone: e.target.value })}\n              className=\"w-full p-2 text-sm border rounded-lg\"\n              placeholder=\"8888-8888\"\n            />\n          </div>\n\n          <div>\n            <label className=\"text-xs font-medium text-slate-600\">Dirección</label>\n            <input\n              type=\"text\"\n              value={form.address}\n              onChange={(e) => setForm({ ...form, address: e.target.value })}\n              className=\"w-full p-2 text-sm border rounded-lg\"\n              placeholder=\"Dirección completa\"\n            />\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div>\n              <label className=\"text-xs font-medium text-slate-600\">Ciudad</label>\n              <input\n                type=\"text\"\n                value={form.city}\n                onChange={(e) => setForm({ ...form, city: e.target.value })}\n                className=\"w-full p-2 text-sm border rounded-lg\"\n                placeholder=\"Ciudad\"\n              />\n            </div>\n            <div>\n              <label className=\"text-xs font-medium text-slate-600\">Municipio</label>\n              <input\n                type=\"text\"\n                value={form.municipio}\n                onChange={(e) => setForm({ ...form, municipio: e.target.value })}\n                className=\"w-full p-2 text-sm border rounded-lg\"\n                placeholder=\"Municipio\"\n              />\n            </div>\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div>\n              <label className=\"text-xs font-medium text-slate-600\">Tipo de Animal</label>\n              <select\n                value={form.animal_type}\n                onChange={(e) => setForm({ ...form, animal_type: e.target.value })}\n                className=\"w-full p-2 text-sm border rounded-lg\"\n              >\n                <option value=\"\">Seleccionar...</option>\n                {animalTypes.map((type) => (\n                  <option key={type} value={type}>{type}</option>\n                ))}\n              </select>\n            </div>\n            <div>\n              <label className=\"text-xs font-medium text-slate-600\">Etapa de Venta</label>\n              <select\n                value={form.sales_stage}\n                onChange={(e) => setForm({ ...form, sales_stage: e.target.value })}\n                className=\"w-full p-2 text-sm border rounded-lg\"\n              >\n                {salesStages.map((stage) => (\n                  <option key={stage.value} value={stage.value}>{stage.label}</option>\n                ))}\n              </select>\n            </div>\n          </div>\n\n          <div className=\"flex justify-end gap-2 pt-4 border-t\">\n            <button type=\"button\" onClick={onClose} className=\"px-4 py-2 text-sm text-slate-600 hover:bg-slate-100 rounded-lg\">\n              Cancelar\n            </button>\n            <button type=\"submit\" disabled={saving} className=\"px-4 py-2 bg-slate-900 text-white rounded-lg text-sm hover:bg-slate-800 disabled:opacity-50\">\n              {saving ? \"Guardando...\" : client ? \"Actualizar\" : \"Crear Cliente\"}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2750, "column": 0}, "map": {"version":3,"sources":["file:///Users/percyscastillo/Desktop/proyectos%20coding/agro-erp-production-2/src/modules/crm/CrmScreen.jsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState } from \"react\";\nimport { useCrm } from \"./hooks/useCrm\";\nimport CrmStats from \"./components/CrmStats\";\nimport CrmFilters from \"./components/CrmFilters\";\nimport PipelineBoard from \"./components/PipelineBoard\";\nimport ClientStagesTable from \"./components/ClientStagesTable\";\nimport OpportunityModal from \"./components/OpportunityModal\";\nimport ActivityModal from \"./components/ActivityModal\";\nimport SalesFunnel from \"./components/SalesFunnel\";\nimport ClientModal from \"./components/ClientModal\";\n\nexport default function CrmScreen({ orgSlug }) {\n  const crm = useCrm(orgSlug);\n  const [activeTab, setActiveTab] = useState(\"pipeline\");\n\n  if (crm.loading) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <p className=\"text-slate-500\">Cargando CRM...</p>\n      </div>\n    );\n  }\n\n  if (crm.error) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <p className=\"text-red-500\">Error: {crm.error}</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-5 max-w-full mx-auto\">\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-lg font-semibold text-slate-800\">\n            CRM - Pipeline de Ventas\n          </h1>\n          <p className=\"text-xs text-slate-500\">\n            Gestión del ciclo de ventas y seguimiento de clientes\n          </p>\n        </div>\n\n        <div className=\"flex gap-2\">\n          <button\n            onClick={crm.openNewClient}\n            className=\"px-3 py-2 bg-emerald-600 text-white rounded-lg text-xs hover:bg-emerald-700\"\n          >\n            + Nuevo Cliente\n          </button>\n          <button\n            onClick={crm.openNewOpportunity}\n            className=\"px-3 py-2 bg-slate-900 text-white rounded-lg text-xs hover:bg-slate-800\"\n          >\n            + Nueva Oportunidad\n          </button>\n        </div>\n      </div>\n\n      <CrmStats stats={crm.stats} />\n\n      <div className=\"bg-white border rounded-xl shadow-sm overflow-hidden\">\n        <div className=\"border-b\">\n          <nav className=\"flex\">\n            <button\n              onClick={() => setActiveTab(\"pipeline\")}\n              className={`px-4 py-3 text-sm font-medium ${\n                activeTab === \"pipeline\"\n                  ? \"border-b-2 border-slate-900 text-slate-900\"\n                  : \"text-slate-500 hover:text-slate-700\"\n              }`}\n            >\n              Pipeline\n            </button>\n            <button\n              onClick={() => setActiveTab(\"clients\")}\n              className={`px-4 py-3 text-sm font-medium ${\n                activeTab === \"clients\"\n                  ? \"border-b-2 border-slate-900 text-slate-900\"\n                  : \"text-slate-500 hover:text-slate-700\"\n              }`}\n            >\n              Clientes por Etapa\n            </button>\n            <button\n              onClick={() => setActiveTab(\"all-clients\")}\n              className={`px-4 py-3 text-sm font-medium ${\n                activeTab === \"all-clients\"\n                  ? \"border-b-2 border-slate-900 text-slate-900\"\n                  : \"text-slate-500 hover:text-slate-700\"\n              }`}\n            >\n              Todos los Clientes ({crm.clients.length})\n            </button>\n            <button\n              onClick={() => setActiveTab(\"funnel\")}\n              className={`px-4 py-3 text-sm font-medium ${\n                activeTab === \"funnel\"\n                  ? \"border-b-2 border-slate-900 text-slate-900\"\n                  : \"text-slate-500 hover:text-slate-700\"\n              }`}\n            >\n              Embudo de Ventas\n            </button>\n          </nav>\n        </div>\n\n        {activeTab === \"pipeline\" && (\n          <div className=\"p-4\">\n            <PipelineBoard\n              pipelineData={crm.pipelineData}\n              onMoveOpportunity={crm.moveOpportunityToStage}\n              onEditOpportunity={crm.openEditOpportunity}\n              onDeleteOpportunity={crm.deleteOpportunity}\n              onAddActivity={crm.openActivityModal}\n              onMarkWon={crm.markOpportunityWon}\n              onMarkLost={crm.markOpportunityLost}\n            />\n          </div>\n        )}\n\n        {activeTab === \"clients\" && (\n          <>\n            <div className=\"px-4 py-3 border-b\">\n              <CrmFilters\n                search={crm.search}\n                setSearch={crm.setSearch}\n                stageFilter={crm.stageFilter}\n                setStageFilter={crm.setStageFilter}\n                stages={crm.stages}\n              />\n            </div>\n            <div className=\"p-4\">\n              <ClientStagesTable\n                clientsByStage={crm.clientsByStage}\n                stages={crm.stages}\n                onViewOpportunities={crm.openEditOpportunity}\n              />\n            </div>\n          </>\n        )}\n\n        {activeTab === \"all-clients\" && (\n          <div className=\"p-4\">\n            <div className=\"mb-4\">\n              <input\n                type=\"text\"\n                placeholder=\"Buscar cliente...\"\n                value={crm.search}\n                onChange={(e) => crm.setSearch(e.target.value)}\n                className=\"w-full max-w-md p-2 text-sm border rounded-lg\"\n              />\n            </div>\n            <table className=\"w-full text-sm\">\n              <thead className=\"bg-slate-50 border-b\">\n                <tr>\n                  <th className=\"text-left p-3 font-medium text-slate-600\">Nombre</th>\n                  <th className=\"text-left p-3 font-medium text-slate-600\">Teléfono</th>\n                  <th className=\"text-left p-3 font-medium text-slate-600\">Ciudad</th>\n                  <th className=\"text-left p-3 font-medium text-slate-600\">Tipo Animal</th>\n                  <th className=\"text-left p-3 font-medium text-slate-600\">Etapa</th>\n                  <th className=\"text-center p-3 font-medium text-slate-600\">Acciones</th>\n                </tr>\n              </thead>\n              <tbody>\n                {crm.clients\n                  .filter((c) => {\n                    if (!crm.search) return true;\n                    const term = crm.search.toLowerCase();\n                    const name = `${c.first_name || \"\"} ${c.last_name || \"\"}`.toLowerCase();\n                    return name.includes(term) || c.phone?.includes(term) || c.city?.toLowerCase().includes(term);\n                  })\n                  .map((client) => (\n                    <tr key={client.id} className=\"border-b hover:bg-slate-50\">\n                      <td className=\"p-3 font-medium\">{client.first_name} {client.last_name}</td>\n                      <td className=\"p-3 text-slate-500\">{client.phone || \"-\"}</td>\n                      <td className=\"p-3 text-slate-500\">{client.city || \"-\"}</td>\n                      <td className=\"p-3 text-slate-500\">{client.animal_type || \"-\"}</td>\n                      <td className=\"p-3\">\n                        <span className=\"px-2 py-1 text-xs rounded-full bg-slate-100 text-slate-700\">\n                          {client.sales_stage || \"prospecto\"}\n                        </span>\n                      </td>\n                      <td className=\"p-3 text-center\">\n                        <button\n                          onClick={() => crm.openEditClient(client)}\n                          className=\"text-blue-600 hover:underline text-xs mr-2\"\n                        >\n                          Editar\n                        </button>\n                        <button\n                          onClick={() => {\n                            if (confirm(\"¿Eliminar este cliente?\")) {\n                              crm.deleteClient(client.id);\n                            }\n                          }}\n                          className=\"text-red-600 hover:underline text-xs\"\n                        >\n                          Eliminar\n                        </button>\n                      </td>\n                    </tr>\n                  ))}\n                {crm.clients.length === 0 && (\n                  <tr>\n                    <td colSpan=\"6\" className=\"p-8 text-center text-slate-400\">\n                      No hay clientes. Haz clic en \"+ Nuevo Cliente\" para agregar uno.\n                    </td>\n                  </tr>\n                )}\n              </tbody>\n            </table>\n          </div>\n        )}\n\n        {activeTab === \"funnel\" && (\n          <div className=\"p-4\">\n            <SalesFunnel pipelineData={crm.pipelineData} />\n          </div>\n        )}\n      </div>\n\n      <OpportunityModal\n        isOpen={crm.isOpportunityModalOpen}\n        onClose={crm.closeOpportunityModal}\n        onSave={crm.saveOpportunity}\n        opportunity={crm.editingOpportunity}\n        stages={crm.stages}\n        clients={crm.clients}\n      />\n\n      <ActivityModal\n        isOpen={crm.isActivityModalOpen}\n        onClose={crm.closeActivityModal}\n        onSave={crm.saveActivity}\n        opportunity={crm.selectedOpportunityForActivity}\n      />\n\n      <ClientModal\n        isOpen={crm.isClientModalOpen}\n        onClose={crm.closeClientModal}\n        onSave={crm.saveClient}\n        client={crm.editingClient}\n      />\n    </div>\n  );\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3298, "column": 0}, "map": {"version":3,"sources":["file:///Users/percyscastillo/Desktop/proyectos%20coding/agro-erp-production-2/app/%5BorgSlug%5D/crm/page.jsx"],"sourcesContent":["\"use client\";\n\nimport CrmScreen from \"@/src/modules/crm/CrmScreen\";\n\nexport default async function CrmPage({ params }) {\n  const { orgSlug } = await params;\n  return <CrmScreen orgSlug={orgSlug} />;\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAIe,eAAe,QAAQ,EAAE,MAAM,EAAE;IAC9C,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM;IAC1B,qBAAO,+PAAC,mNAAS;QAAC,SAAS;;;;;;AAC7B;KAH8B"}}]
}