{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/percyscastillo/Desktop/proyectos%20coding/agro-erp-production-2/src/modules/inventory/hooks/useInventory.js"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useMemo, useState } from \"react\";\n\nexport const CATEGORIES = [\n  \"Alimentos\",\n  \"Medicinas\",\n  \"Accesorios\",\n  \"Herramientas\",\n  \"Otros\",\n];\n\nexport function useInventory(orgSlug) {\n  const [inventory, setInventory] = useState([]);\n  const [branches, setBranches] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  const [search, setSearch] = useState(\"\");\n  const [category, setCategory] = useState(\"TODOS\");\n  const [branch, setBranch] = useState(\"TODAS\");\n  const [lowStockOnly, setLowStockOnly] = useState(false);\n\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [editingProduct, setEditingProduct] = useState(null);\n\n  /* ===========================================================\n   * LOAD INVENTORY\n   * =========================================================== */\n  async function loadInventory() {\n    try {\n      setLoading(true);\n\n      const res = await fetch(\"/api/inventory/stock\", {\n        headers: { \"x-org-slug\": orgSlug },\n      });\n\n      const json = await res.json();\n      console.log(\"INVENTORY RAW JSON:\", json);\n\n      if (json.stock) {\n        const mapped = json.stock.map((item) => ({\n          id: `${item.product_id}-${item.branch_id}`,\n          productId: item.product_id,\n\n          branchId: item.branch_id,\n          branch: item.branch_name ?? \"Sin sucursal\",\n\n          name: item.name,\n          sku: item.sku ?? item.product_id,\n          category: item.category,\n\n          stock: Number(item.stock ?? 0),\n\n          minStock: item.min_stock ?? 0,\n\n          cost: item.cost ?? 0,\n          price: item.price ?? 0,\n\n          unitWeight: item.unit_weight ?? 0,\n          expiresAt: item.expires_at ?? null,\n        }));\n\n        console.log(\"INVENTORY MAPPED:\", mapped);\n        setInventory(mapped);\n      }\n\n      if (json.branches) setBranches(json.branches);\n\n    } catch (err) {\n      console.error(\"Inventory fetch error:\", err);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  useEffect(() => {\n    if (orgSlug) loadInventory();\n  }, [orgSlug]);\n\n  const getStock = (p) => Number(p.stock ?? 0);\n\n  /* ===========================================================\n   * FILTERED PRODUCTS\n   * =========================================================== */\n  const filteredProducts = useMemo(() => {\n    const term = search.toLowerCase();\n\n    return inventory.filter((p) => {\n      const matchesCategory = category === \"TODOS\" || p.category === category;\n      const matchesBranch = branch === \"TODAS\" || p.branch === branch;\n\n      const matchesSearch =\n        p.name?.toLowerCase().includes(term) ||\n        String(p.sku).toLowerCase().includes(term);\n\n      const matchesLowStock = lowStockOnly\n        ? getStock(p) <= Number(p.minStock ?? 0)\n        : true;\n\n      return (\n        matchesCategory &&\n        matchesBranch &&\n        matchesSearch &&\n        matchesLowStock\n      );\n    });\n  }, [inventory, search, category, branch, lowStockOnly]);\n\n  /* ===========================================================\n   * STATS\n   * =========================================================== */\n  const stats = useMemo(() => {\n    const totalProducts = inventory.length;\n\n    const totalUnits = inventory.reduce(\n      (sum, p) => sum + getStock(p),\n      0\n    );\n\n    const inventoryValue = inventory.reduce(\n      (sum, p) => sum + getStock(p) * (p.cost ?? 0),\n      0\n    );\n\n    const potentialRevenue = inventory.reduce(\n      (sum, p) => sum + getStock(p) * (p.price ?? 0),\n      0\n    );\n\n    const lowStockCount = inventory.filter(\n      (p) => getStock(p) <= Number(p.minStock ?? 0)\n    ).length;\n\n    return {\n      totalProducts,\n      totalUnits,\n      inventoryValue,\n      potentialRevenue,\n      lowStockCount,\n    };\n  }, [inventory]);\n\n  /* ===========================================================\n   * MODAL HANDLERS\n   * =========================================================== */\n  function openNewProduct() {\n    setEditingProduct(null);\n    setIsModalOpen(true);\n  }\n\n  function openEditProduct(product) {\n    setEditingProduct(product);\n    setIsModalOpen(true);\n  }\n\n  function closeModal() {\n    setIsModalOpen(false);\n    setEditingProduct(null);\n  }\n\n  /* ===========================================================\n   * SAVE PRODUCT\n   * =========================================================== */\n  async function saveProduct(data) {\n    try {\n      const method = data.productId ? \"PUT\" : \"POST\";\n\n      const res = await fetch(\"/api/products\", {\n        method,\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"x-org-slug\": orgSlug,\n        },\n        body: JSON.stringify({\n          id: data.productId,\n          name: data.name,\n          sku: data.sku,\n          category: data.category,\n          unitWeight: data.unitWeight,\n          minStock: data.minStock,\n          cost: data.cost,\n          price: data.price,\n          expiresAt: data.expiresAt,\n          branchId: data.branchId,\n        }),\n      });\n\n      if (!res.ok) {\n        const err = await res.json();\n        throw new Error(err.error || \"Error al guardar producto\");\n      }\n\n      await loadInventory();\n      closeModal();\n      return { success: true };\n\n    } catch (err) {\n      console.error(\"Save product error:\", err);\n      return { success: false, error: err.message };\n    }\n  }\n\n  /* ===========================================================\n   * DELETE PRODUCT\n   * =========================================================== */\n  async function deleteProduct(id) {\n    try {\n      const product = inventory.find((p) => p.id === id);\n      if (!product) return { success: false, error: \"Producto no encontrado\" };\n\n      const res = await fetch(\"/api/inventory\", {\n        method: \"DELETE\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"x-org-slug\": orgSlug,\n        },\n        body: JSON.stringify({ productId: product.productId }),\n      });\n\n      if (!res.ok) {\n        const err = await res.json();\n        throw new Error(err.error || \"Error al eliminar producto\");\n      }\n\n      setInventory((prev) =>\n        prev.filter((p) => p.productId !== product.productId)\n      );\n\n      return { success: true };\n\n    } catch (err) {\n      console.error(\"Delete product error:\", err);\n      return { success: false, error: err.message };\n    }\n  }\n\n  /* ===========================================================\n   * RETURN\n   * =========================================================== */\n  return {\n    products: inventory,\n    filteredProducts,\n    stats,\n    branches,\n\n    search,\n    setSearch,\n    category,\n    setCategory,\n    branch,\n    setBranch,\n    lowStockOnly,\n    setLowStockOnly,\n\n    isModalOpen,\n    editingProduct,\n    openNewProduct,\n    openEditProduct,\n    closeModal,\n\n    saveProduct,\n    deleteProduct,\n    loadInventory,\n\n    loading,\n    setProducts: setInventory,\n  };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 231, "column": 0}, "map": {"version":3,"sources":["file:///Users/percyscastillo/Desktop/proyectos%20coding/agro-erp-production-2/src/modules/inventory/components/InventoryFilters.jsx"],"sourcesContent":["\"use client\";\n\nimport React from \"react\";\nimport { Search } from \"lucide-react\";\n\nexport default function InventoryFilters({\n  search,\n  setSearch,\n  category,\n  setCategory,\n  branch,\n  setBranch,\n  lowStockOnly,\n  setLowStockOnly,\n  categories = [],\n  branches = [],\n}) {\n  return (\n    <div className=\"flex flex-wrap items-end gap-4 mb-6\">\n\n      {/* SEARCH */}\n      <div className=\"flex-1 min-w-[220px]\">\n        <label className=\"text-xs font-semibold text-slate-600\">\n          Buscar\n        </label>\n        <div className=\"relative\">\n          <Search className=\"h-4 w-4 text-slate-400 absolute left-3 top-[10px]\" />\n          <input\n            type=\"text\"\n            placeholder=\"Nombre o cÃ³digo...\"\n            value={search}\n            onChange={(e) => setSearch(e.target.value)}\n            className=\"\n              w-full pl-9 pr-3 py-2.5\n              border border-slate-300\n              rounded-xl\n              text-sm\n              placeholder:text-slate-400\n              focus:ring-2 focus:ring-blue-500 focus:border-blue-500\n              transition\n            \"\n          />\n        </div>\n      </div>\n\n      {/* CATEGORY */}\n      <div className=\"w-[160px]\">\n        <label className=\"text-xs font-semibold text-slate-600\">\n          CategorÃ­a\n        </label>\n        <select\n          value={category}\n          onChange={(e) => setCategory(e.target.value)}\n          className=\"\n            w-full\n            border border-slate-300\n            rounded-xl\n            text-sm\n            py-2.5 px-3\n            bg-white\n            focus:ring-2 focus:ring-blue-500 focus:border-blue-500\n          \"\n        >\n          <option value=\"TODOS\">Todas</option>\n          {categories.map((c) => (\n            <option key={c} value={c}>{c}</option>\n          ))}\n        </select>\n      </div>\n\n      {/* BRANCH */}\n      <div className=\"w-[160px]\">\n        <label className=\"text-xs font-semibold text-slate-600\">\n          Bodega\n        </label>\n        <select\n          value={branch}\n          onChange={(e) => setBranch(e.target.value)}\n          className=\"\n            w-full\n            border border-slate-300\n            rounded-xl\n            text-sm\n            py-2.5 px-3\n            bg-white\n            focus:ring-2 focus:ring-blue-500 focus:border-blue-500\n          \"\n        >\n          <option value=\"TODAS\">Todas</option>\n          {branches.map((b) => {\n            const name = typeof b === \"string\" ? b : b.name;\n            return <option key={name} value={name}>{name}</option>;\n          })}\n        </select>\n      </div>\n\n      {/* LOW STOCK */}\n      <div className=\"flex items-center gap-2 pt-5\">\n        <input\n          id=\"lowStock\"\n          type=\"checkbox\"\n          checked={lowStockOnly}\n          onChange={(e) => setLowStockOnly(e.target.checked)}\n          className=\"h-4 w-4 accent-blue-600\"\n        />\n        <label htmlFor=\"lowStock\" className=\"text-xs text-slate-700\">\n          Solo bajo stock\n        </label>\n      </div>\n\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAKe,SAAS,iBAAiB,EACvC,MAAM,EACN,SAAS,EACT,QAAQ,EACR,WAAW,EACX,MAAM,EACN,SAAS,EACT,YAAY,EACZ,eAAe,EACf,aAAa,EAAE,EACf,WAAW,EAAE,EACd;IACC,qBACE,gTAAC;QAAI,WAAU;;0BAGb,gTAAC;gBAAI,WAAU;;kCACb,gTAAC;wBAAM,WAAU;kCAAuC;;;;;;kCAGxD,gTAAC;wBAAI,WAAU;;0CACb,gTAAC,kRAAM;gCAAC,WAAU;;;;;;0CAClB,gTAAC;gCACC,MAAK;gCACL,aAAY;gCACZ,OAAO;gCACP,UAAU,CAAC,IAAM,UAAU,EAAE,MAAM,CAAC,KAAK;gCACzC,WAAU;;;;;;;;;;;;;;;;;;0BAchB,gTAAC;gBAAI,WAAU;;kCACb,gTAAC;wBAAM,WAAU;kCAAuC;;;;;;kCAGxD,gTAAC;wBACC,OAAO;wBACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;wBAC3C,WAAU;;0CAUV,gTAAC;gCAAO,OAAM;0CAAQ;;;;;;4BACrB,WAAW,GAAG,CAAC,CAAC,kBACf,gTAAC;oCAAe,OAAO;8CAAI;mCAAd;;;;;;;;;;;;;;;;;0BAMnB,gTAAC;gBAAI,WAAU;;kCACb,gTAAC;wBAAM,WAAU;kCAAuC;;;;;;kCAGxD,gTAAC;wBACC,OAAO;wBACP,UAAU,CAAC,IAAM,UAAU,EAAE,MAAM,CAAC,KAAK;wBACzC,WAAU;;0CAUV,gTAAC;gCAAO,OAAM;0CAAQ;;;;;;4BACrB,SAAS,GAAG,CAAC,CAAC;gCACb,MAAM,OAAO,OAAO,MAAM,WAAW,IAAI,EAAE,IAAI;gCAC/C,qBAAO,gTAAC;oCAAkB,OAAO;8CAAO;mCAApB;;;;;4BACtB;;;;;;;;;;;;;0BAKJ,gTAAC;gBAAI,WAAU;;kCACb,gTAAC;wBACC,IAAG;wBACH,MAAK;wBACL,SAAS;wBACT,UAAU,CAAC,IAAM,gBAAgB,EAAE,MAAM,CAAC,OAAO;wBACjD,WAAU;;;;;;kCAEZ,gTAAC;wBAAM,SAAQ;wBAAW,WAAU;kCAAyB;;;;;;;;;;;;;;;;;;AAOrE"}},
    {"offset": {"line": 421, "column": 0}, "map": {"version":3,"sources":["file:///Users/percyscastillo/Desktop/proyectos%20coding/agro-erp-production-2/src/modules/inventory/components/InventoryGrid.jsx"],"sourcesContent":["\"use client\";\n\nimport React, { useMemo, useState } from \"react\";\n\nfunction computeDaysToExpire(expiresAt) {\n  if (!expiresAt) return null;\n  const today = new Date();\n  const base = new Date(today.getFullYear(), today.getMonth(), today.getDate());\n  const exp = new Date(expiresAt + \"T00:00:00\");\n  return Math.ceil((exp - base) / (1000 * 60 * 60 * 24));\n}\n\nexport default function InventoryGrid({\n  products,\n  stats,\n  onEdit,\n  onDelete,\n  onEntry,\n  onExit,\n  onTransfer,\n  onKardex,\n  orgSlug,\n}) {\n  const safeProducts = Array.isArray(products) ? products : [];\n  const [deleteConfirm, setDeleteConfirm] = useState(null);\n\n  const getStock = (p) => p.stock ?? p.quantity ?? 0;\n  const getUnitWeight = (p) =>\n    p.unitWeight ?? p.unidad_medida ?? p.unit_medida ?? 0;\n\n  const [sortConfig, setSortConfig] = useState({\n    key: \"name\",\n    direction: \"asc\",\n  });\n\n  const getSortValue = (p, key) => {\n    switch (key) {\n      case \"costTotal\":\n        return getStock(p) * (p.cost ?? 0);\n      case \"pricePerLb\": {\n        const w = getUnitWeight(p);\n        return p.price && w ? p.price / w : null;\n      }\n      case \"daysToExpire\":\n        return computeDaysToExpire(p.expiresAt);\n      default:\n        return p[key];\n    }\n  };\n\n  const sortedProducts = useMemo(() => {\n    const arr = [...safeProducts];\n    if (!sortConfig.key) return arr;\n\n    return arr.sort((a, b) => {\n      const va = getSortValue(a, sortConfig.key);\n      const vb = getSortValue(b, sortConfig.key);\n\n      if (va == null) return 1;\n      if (vb == null) return -1;\n\n      if (va < vb) return sortConfig.direction === \"asc\" ? -1 : 1;\n      if (va > vb) return sortConfig.direction === \"asc\" ? 1 : -1;\n\n      return 0;\n    });\n  }, [safeProducts, sortConfig]);\n\n  const {\n    totalProducts = safeProducts.length,\n    totalUnits = safeProducts.reduce((sum, p) => sum + getStock(p), 0),\n    inventoryValue = safeProducts.reduce(\n      (sum, p) => sum + getStock(p) * (p.cost ?? 0),\n      0\n    ),\n    potentialRevenue = safeProducts.reduce(\n      (sum, p) => sum + getStock(p) * (p.price ?? 0),\n      0\n    ),\n  } = stats || {};\n\n  const handleDeleteClick = (product) => setDeleteConfirm(product);\n\n  const confirmDelete = async () => {\n    if (deleteConfirm && onDelete) {\n      await onDelete(deleteConfirm.id);\n      setDeleteConfirm(null);\n    }\n  };\n\n  return (\n    <div className=\"space-y-3\">\n\n      {/* DELETE CONFIRM MODAL */}\n      {deleteConfirm && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\n          <div className=\"bg-white rounded-lg p-6 max-w-md w-full mx-4 shadow-xl\">\n            <h3 className=\"text-lg font-semibold text-slate-800\">\n              Confirmar eliminaciÃ³n\n            </h3>\n\n            <p className=\"text-slate-600 my-4\">\n              Â¿Eliminar <strong>{deleteConfirm.name}</strong>? Esta acciÃ³n es permanente.\n            </p>\n\n            <div className=\"flex justify-end gap-3\">\n              <button\n                onClick={() => setDeleteConfirm(null)}\n                className=\"px-4 py-2 bg-slate-200 rounded\"\n              >\n                Cancelar\n              </button>\n              <button\n                onClick={confirmDelete}\n                className=\"px-4 py-2 bg-red-600 text-white rounded\"\n              >\n                Eliminar\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* KPIs */}\n      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3 text-[11px]\">\n        <div className=\"bg-slate-50 border rounded-lg px-3 py-2\">\n          <p className=\"text-slate-500\">Productos</p>\n          <p className=\"text-lg font-semibold\">{totalProducts}</p>\n        </div>\n\n        <div className=\"bg-slate-50 border rounded-lg px-3 py-2\">\n          <p className=\"text-slate-500\">Unidades</p>\n          <p className=\"text-lg font-semibold\">\n            {totalUnits.toLocaleString(\"es-NI\")}\n          </p>\n        </div>\n\n        <div className=\"bg-slate-50 border rounded-lg px-3 py-2\">\n          <p className=\"text-slate-500\">Valor inventario</p>\n          <p className=\"text-lg font-semibold text-emerald-700\">\n            C$ {inventoryValue.toLocaleString(\"es-NI\")}\n          </p>\n        </div>\n\n        <div className=\"bg-slate-50 border rounded-lg px-3 py-2\">\n          <p className=\"text-slate-500\">Potencial de venta</p>\n          <p className=\"text-lg font-semibold text-indigo-700\">\n            C$ {potentialRevenue.toLocaleString(\"es-NI\")}\n          </p>\n        </div>\n      </div>\n\n      {/* TABLE */}\n      <div className=\"w-full overflow-auto max-h-[520px]\">\n        <table className=\"min-w-full text-[12px]\">\n          <thead>\n            <tr className=\"bg-slate-50 border-b text-[11px] uppercase text-slate-500\">\n              <th className=\"px-2 py-2\">Producto</th>\n              <th className=\"px-2 py-2\">CÃ³digo</th>\n              <th className=\"px-2 py-2\">CategorÃ­a</th>\n              <th className=\"px-2 py-2\">Bodega</th>\n              <th className=\"px-2 py-2 text-right\">Cantidad</th>\n              <th className=\"px-2 py-2 text-right\">Peso</th>\n              <th className=\"px-2 py-2 text-right\">Costo</th>\n              <th className=\"px-2 py-2 text-right\">Costo total</th>\n              <th className=\"px-2 py-2 text-right\">Precio</th>\n              <th className=\"px-2 py-2 text-right\">Precio x lb</th>\n              <th className=\"px-2 py-2 text-right\">DÃ­as p/ vencer</th>\n              <th className=\"px-2 py-2\">Vence</th>\n              <th className=\"px-2 py-2 text-right\">Acciones</th>\n            </tr>\n          </thead>\n\n          <tbody>\n            {sortedProducts.length === 0 ? (\n              <tr>\n                <td\n                  colSpan={13}\n                  className=\"px-3 py-4 text-center text-slate-400\"\n                >\n                  No hay productos\n                </td>\n              </tr>\n            ) : (\n              sortedProducts.map((p) => {\n                const stock = getStock(p);\n                const weight = getUnitWeight(p);\n                const pricePerLb =\n                  p.price && weight ? p.price / weight : null;\n\n                const costTotal = stock * (p.cost ?? 0);\n\n                return (\n                  <tr\n                    key={p.id}\n                    className=\"border-b hover:bg-slate-50 transition\"\n                  >\n                    <td className=\"px-2 py-1.5\">{p.name}</td>\n                    <td className=\"px-2 py-1.5\">{p.sku ?? p.id}</td>\n                    <td className=\"px-2 py-1.5\">{p.category}</td>\n                    <td className=\"px-2 py-1.5\">{p.branch ?? p.branch_name}</td>\n                    <td className=\"px-2 py-1.5 text-right\">{stock}</td>\n                    <td className=\"px-2 py-1.5 text-right\">{weight}</td>\n                    <td className=\"px-2 py-1.5 text-right\">\n                      C$ {p.cost?.toLocaleString(\"es-NI\")}\n                    </td>\n                    <td className=\"px-2 py-1.5 text-right\">\n                      C$ {costTotal.toLocaleString(\"es-NI\")}\n                    </td>\n                    <td className=\"px-2 py-1.5 text-right\">\n                      C$ {p.price?.toLocaleString(\"es-NI\")}\n                    </td>\n                    <td className=\"px-2 py-1.5 text-right\">\n                      {pricePerLb ? `C$ ${pricePerLb.toFixed(2)}` : \"-\"}\n                    </td>\n                    <td className=\"px-2 py-1.5 text-right\">\n                      {computeDaysToExpire(p.expiresAt) ?? \"â€”\"}\n                    </td>\n                    <td className=\"px-2 py-1.5\">{p.expiresAt}</td>\n\n                    {/* ACTIONS */}\n                    <td className=\"px-2 py-1.5 text-right\">\n                      <div className=\"flex justify-end gap-1 flex-wrap\">\n\n                        {/* ðŸ”¥ HISTORIAL / KARDEX (UUID LIMPIO) */}\n                        <button\n                          onClick={() => {\n                            let pid = p.product_id ?? p.id;\n                            pid = String(pid);\n\n                            // cortar solo las 5 partes vÃ¡lidas UUID\n                            const cleanUUID = pid\n                              .split(\"-\")\n                              .slice(0, 5)\n                              .join(\"-\");\n\n                            onKardex({\n                              ...p,\n                              productId: cleanUUID,\n                            });\n                          }}\n                          className=\"px-2 py-1 text-[11px] bg-purple-600 text-white rounded hover:bg-purple-700\"\n                        >\n                          Historial â–¸\n                        </button>\n\n                        <button\n                          onClick={() => onEntry && onEntry(p)}\n                          className=\"px-2 py-1 text-[11px] bg-emerald-600 text-white rounded\"\n                        >\n                          Entrada\n                        </button>\n\n                        <button\n                          onClick={() => onExit && onExit(p)}\n                          className=\"px-2 py-1 text-[11px] bg-orange-600 text-white rounded\"\n                        >\n                          Salida\n                        </button>\n\n                        <button\n                          onClick={() => onTransfer && onTransfer(p)}\n                          className=\"px-2 py-1 text-[11px] bg-blue-600 text-white rounded\"\n                        >\n                          Traslado\n                        </button>\n\n                        <button\n                          onClick={() => onEdit && onEdit(p)}\n                          className=\"px-2 py-1 text-[11px] bg-slate-800 text-white rounded\"\n                        >\n                          Editar\n                        </button>\n\n                        <button\n                          onClick={() => setDeleteConfirm(p)}\n                          className=\"px-2 py-1 text-[11px] bg-red-600 text-white rounded\"\n                        >\n                          Eliminar\n                        </button>\n\n                      </div>\n                    </td>\n                  </tr>\n                );\n              })\n            )}\n          </tbody>\n\n        </table>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAIA,SAAS,oBAAoB,SAAS;IACpC,IAAI,CAAC,WAAW,OAAO;IACvB,MAAM,QAAQ,IAAI;IAClB,MAAM,OAAO,IAAI,KAAK,MAAM,WAAW,IAAI,MAAM,QAAQ,IAAI,MAAM,OAAO;IAC1E,MAAM,MAAM,IAAI,KAAK,YAAY;IACjC,OAAO,KAAK,IAAI,CAAC,CAAC,MAAM,IAAI,IAAI,CAAC,OAAO,KAAK,KAAK,EAAE;AACtD;AAEe,SAAS,cAAc,EACpC,QAAQ,EACR,KAAK,EACL,MAAM,EACN,QAAQ,EACR,OAAO,EACP,MAAM,EACN,UAAU,EACV,QAAQ,EACR,OAAO,EACR;IACC,MAAM,eAAe,MAAM,OAAO,CAAC,YAAY,WAAW,EAAE;IAC5D,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,mRAAQ,EAAC;IAEnD,MAAM,WAAW,CAAC,IAAM,EAAE,KAAK,IAAI,EAAE,QAAQ,IAAI;IACjD,MAAM,gBAAgB,CAAC,IACrB,EAAE,UAAU,IAAI,EAAE,aAAa,IAAI,EAAE,WAAW,IAAI;IAEtD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,mRAAQ,EAAC;QAC3C,KAAK;QACL,WAAW;IACb;IAEA,MAAM,eAAe,CAAC,GAAG;QACvB,OAAQ;YACN,KAAK;gBACH,OAAO,SAAS,KAAK,CAAC,EAAE,IAAI,IAAI,CAAC;YACnC,KAAK;gBAAc;oBACjB,MAAM,IAAI,cAAc;oBACxB,OAAO,EAAE,KAAK,IAAI,IAAI,EAAE,KAAK,GAAG,IAAI;gBACtC;YACA,KAAK;gBACH,OAAO,oBAAoB,EAAE,SAAS;YACxC;gBACE,OAAO,CAAC,CAAC,IAAI;QACjB;IACF;IAEA,MAAM,iBAAiB,IAAA,kRAAO,EAAC;QAC7B,MAAM,MAAM;eAAI;SAAa;QAC7B,IAAI,CAAC,WAAW,GAAG,EAAE,OAAO;QAE5B,OAAO,IAAI,IAAI,CAAC,CAAC,GAAG;YAClB,MAAM,KAAK,aAAa,GAAG,WAAW,GAAG;YACzC,MAAM,KAAK,aAAa,GAAG,WAAW,GAAG;YAEzC,IAAI,MAAM,MAAM,OAAO;YACvB,IAAI,MAAM,MAAM,OAAO,CAAC;YAExB,IAAI,KAAK,IAAI,OAAO,WAAW,SAAS,KAAK,QAAQ,CAAC,IAAI;YAC1D,IAAI,KAAK,IAAI,OAAO,WAAW,SAAS,KAAK,QAAQ,IAAI,CAAC;YAE1D,OAAO;QACT;IACF,GAAG;QAAC;QAAc;KAAW;IAE7B,MAAM,EACJ,gBAAgB,aAAa,MAAM,EACnC,aAAa,aAAa,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,SAAS,IAAI,EAAE,EAClE,iBAAiB,aAAa,MAAM,CAClC,CAAC,KAAK,IAAM,MAAM,SAAS,KAAK,CAAC,EAAE,IAAI,IAAI,CAAC,GAC5C,EACD,EACD,mBAAmB,aAAa,MAAM,CACpC,CAAC,KAAK,IAAM,MAAM,SAAS,KAAK,CAAC,EAAE,KAAK,IAAI,CAAC,GAC7C,EACD,EACF,GAAG,SAAS,CAAC;IAEd,MAAM,oBAAoB,CAAC,UAAY,iBAAiB;IAExD,MAAM,gBAAgB;QACpB,IAAI,iBAAiB,UAAU;YAC7B,MAAM,SAAS,cAAc,EAAE;YAC/B,iBAAiB;QACnB;IACF;IAEA,qBACE,gTAAC;QAAI,WAAU;;YAGZ,+BACC,gTAAC;gBAAI,WAAU;0BACb,cAAA,gTAAC;oBAAI,WAAU;;sCACb,gTAAC;4BAAG,WAAU;sCAAuC;;;;;;sCAIrD,gTAAC;4BAAE,WAAU;;gCAAsB;8CACvB,gTAAC;8CAAQ,cAAc,IAAI;;;;;;gCAAU;;;;;;;sCAGjD,gTAAC;4BAAI,WAAU;;8CACb,gTAAC;oCACC,SAAS,IAAM,iBAAiB;oCAChC,WAAU;8CACX;;;;;;8CAGD,gTAAC;oCACC,SAAS;oCACT,WAAU;8CACX;;;;;;;;;;;;;;;;;;;;;;;0BAST,gTAAC;gBAAI,WAAU;;kCACb,gTAAC;wBAAI,WAAU;;0CACb,gTAAC;gCAAE,WAAU;0CAAiB;;;;;;0CAC9B,gTAAC;gCAAE,WAAU;0CAAyB;;;;;;;;;;;;kCAGxC,gTAAC;wBAAI,WAAU;;0CACb,gTAAC;gCAAE,WAAU;0CAAiB;;;;;;0CAC9B,gTAAC;gCAAE,WAAU;0CACV,WAAW,cAAc,CAAC;;;;;;;;;;;;kCAI/B,gTAAC;wBAAI,WAAU;;0CACb,gTAAC;gCAAE,WAAU;0CAAiB;;;;;;0CAC9B,gTAAC;gCAAE,WAAU;;oCAAyC;oCAChD,eAAe,cAAc,CAAC;;;;;;;;;;;;;kCAItC,gTAAC;wBAAI,WAAU;;0CACb,gTAAC;gCAAE,WAAU;0CAAiB;;;;;;0CAC9B,gTAAC;gCAAE,WAAU;;oCAAwC;oCAC/C,iBAAiB,cAAc,CAAC;;;;;;;;;;;;;;;;;;;0BAM1C,gTAAC;gBAAI,WAAU;0BACb,cAAA,gTAAC;oBAAM,WAAU;;sCACf,gTAAC;sCACC,cAAA,gTAAC;gCAAG,WAAU;;kDACZ,gTAAC;wCAAG,WAAU;kDAAY;;;;;;kDAC1B,gTAAC;wCAAG,WAAU;kDAAY;;;;;;kDAC1B,gTAAC;wCAAG,WAAU;kDAAY;;;;;;kDAC1B,gTAAC;wCAAG,WAAU;kDAAY;;;;;;kDAC1B,gTAAC;wCAAG,WAAU;kDAAuB;;;;;;kDACrC,gTAAC;wCAAG,WAAU;kDAAuB;;;;;;kDACrC,gTAAC;wCAAG,WAAU;kDAAuB;;;;;;kDACrC,gTAAC;wCAAG,WAAU;kDAAuB;;;;;;kDACrC,gTAAC;wCAAG,WAAU;kDAAuB;;;;;;kDACrC,gTAAC;wCAAG,WAAU;kDAAuB;;;;;;kDACrC,gTAAC;wCAAG,WAAU;kDAAuB;;;;;;kDACrC,gTAAC;wCAAG,WAAU;kDAAY;;;;;;kDAC1B,gTAAC;wCAAG,WAAU;kDAAuB;;;;;;;;;;;;;;;;;sCAIzC,gTAAC;sCACE,eAAe,MAAM,KAAK,kBACzB,gTAAC;0CACC,cAAA,gTAAC;oCACC,SAAS;oCACT,WAAU;8CACX;;;;;;;;;;uCAKH,eAAe,GAAG,CAAC,CAAC;gCAClB,MAAM,QAAQ,SAAS;gCACvB,MAAM,SAAS,cAAc;gCAC7B,MAAM,aACJ,EAAE,KAAK,IAAI,SAAS,EAAE,KAAK,GAAG,SAAS;gCAEzC,MAAM,YAAY,QAAQ,CAAC,EAAE,IAAI,IAAI,CAAC;gCAEtC,qBACE,gTAAC;oCAEC,WAAU;;sDAEV,gTAAC;4CAAG,WAAU;sDAAe,EAAE,IAAI;;;;;;sDACnC,gTAAC;4CAAG,WAAU;sDAAe,EAAE,GAAG,IAAI,EAAE,EAAE;;;;;;sDAC1C,gTAAC;4CAAG,WAAU;sDAAe,EAAE,QAAQ;;;;;;sDACvC,gTAAC;4CAAG,WAAU;sDAAe,EAAE,MAAM,IAAI,EAAE,WAAW;;;;;;sDACtD,gTAAC;4CAAG,WAAU;sDAA0B;;;;;;sDACxC,gTAAC;4CAAG,WAAU;sDAA0B;;;;;;sDACxC,gTAAC;4CAAG,WAAU;;gDAAyB;gDACjC,EAAE,IAAI,EAAE,eAAe;;;;;;;sDAE7B,gTAAC;4CAAG,WAAU;;gDAAyB;gDACjC,UAAU,cAAc,CAAC;;;;;;;sDAE/B,gTAAC;4CAAG,WAAU;;gDAAyB;gDACjC,EAAE,KAAK,EAAE,eAAe;;;;;;;sDAE9B,gTAAC;4CAAG,WAAU;sDACX,aAAa,CAAC,GAAG,EAAE,WAAW,OAAO,CAAC,IAAI,GAAG;;;;;;sDAEhD,gTAAC;4CAAG,WAAU;sDACX,oBAAoB,EAAE,SAAS,KAAK;;;;;;sDAEvC,gTAAC;4CAAG,WAAU;sDAAe,EAAE,SAAS;;;;;;sDAGxC,gTAAC;4CAAG,WAAU;sDACZ,cAAA,gTAAC;gDAAI,WAAU;;kEAGb,gTAAC;wDACC,SAAS;4DACP,IAAI,MAAM,EAAE,UAAU,IAAI,EAAE,EAAE;4DAC9B,MAAM,OAAO;4DAEb,wCAAwC;4DACxC,MAAM,YAAY,IACf,KAAK,CAAC,KACN,KAAK,CAAC,GAAG,GACT,IAAI,CAAC;4DAER,SAAS;gEACP,GAAG,CAAC;gEACJ,WAAW;4DACb;wDACF;wDACA,WAAU;kEACX;;;;;;kEAID,gTAAC;wDACC,SAAS,IAAM,WAAW,QAAQ;wDAClC,WAAU;kEACX;;;;;;kEAID,gTAAC;wDACC,SAAS,IAAM,UAAU,OAAO;wDAChC,WAAU;kEACX;;;;;;kEAID,gTAAC;wDACC,SAAS,IAAM,cAAc,WAAW;wDACxC,WAAU;kEACX;;;;;;kEAID,gTAAC;wDACC,SAAS,IAAM,UAAU,OAAO;wDAChC,WAAU;kEACX;;;;;;kEAID,gTAAC;wDACC,SAAS,IAAM,iBAAiB;wDAChC,WAAU;kEACX;;;;;;;;;;;;;;;;;;mCAnFA,EAAE,EAAE;;;;;4BA2Ff;;;;;;;;;;;;;;;;;;;;;;;AAQd"}},
    {"offset": {"line": 1039, "column": 0}, "map": {"version":3,"sources":["file:///Users/percyscastillo/Desktop/proyectos%20coding/agro-erp-production-2/src/modules/inventory/components/ProductFormModal.jsx"],"sourcesContent":["\"use client\";\n\nimport React, { useEffect, useState } from \"react\";\n\nexport default function ProductFormModal({\n  isOpen,\n  onClose,\n  onSave,\n  product,\n  categories = [],\n  branches = [],\n}) {\n  const [form, setForm] = useState({\n    id: null,\n    productId: null,\n    name: \"\",\n    sku: \"\",\n    category: \"\",\n    branch: \"\",\n    branchId: \"\",\n    unitWeight: 0,\n    minStock: 0,\n    cost: 0,\n    price: 0,\n    unit: \"LB\",\n    expiresAt: \"\",\n  });\n\n  useEffect(() => {\n    if (!isOpen) return;\n\n    const defaultBranch = branches[0];\n    setForm({\n      id: product?.id ?? null,\n      productId: product?.productId ?? null,\n      name: product?.name ?? \"\",\n      sku: product?.sku ?? \"\",\n      category: product?.category ?? categories[0] ?? \"\",\n      branch: product?.branch ?? defaultBranch?.name ?? \"\",\n      branchId: product?.branchId ?? defaultBranch?.id ?? \"\",\n      unitWeight: product?.unitWeight ?? 0,\n      minStock: product?.minStock ?? 0,\n      cost: product?.cost ?? 0,\n      price: product?.price ?? 0,\n      unit: product?.unit ?? \"LB\",\n      expiresAt: product?.expiresAt ?? \"\",\n    });\n  }, [isOpen, product, branches, categories]);\n\n  if (!isOpen) return null;\n\n  function handleChange(e) {\n    const { name, value } = e.target;\n    const numeric = [\"unitWeight\", \"minStock\", \"cost\", \"price\"];\n\n    setForm((prev) => ({\n      ...prev,\n      [name]: numeric.includes(name) ? Number(value) : value,\n    }));\n  }\n\n  function handleSubmit(e) {\n    e.preventDefault();\n    if (!form.name.trim()) return alert(\"El nombre es obligatorio\");\n    if (!form.sku.trim()) return alert(\"El cÃ³digo es obligatorio\");\n    onSave(form);\n  }\n\n  return (\n    <div className=\"fixed inset-0 bg-black/50 z-50 flex items-center justify-center\">\n      <div className=\"w-full max-w-md bg-white rounded-2xl shadow-xl border border-slate-100 p-6\">\n        {/* HEADER */}\n        <div className=\"flex justify-between items-center mb-4\">\n          <h2 className=\"text-base font-semibold text-slate-800\">\n            {product ? \"Editar producto\" : \"Nuevo producto\"}\n          </h2>\n          <button\n            onClick={onClose}\n            className=\"text-xs text-slate-500 hover:text-slate-800\"\n          >\n            Cerrar\n          </button>\n        </div>\n\n        {/* FORM */}\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          <Field label=\"Nombre\">\n            <input\n              name=\"name\"\n              value={form.name}\n              onChange={handleChange}\n              className=\"input-soft\"\n              placeholder=\"Ej: Engordina 100 lb\"\n            />\n          </Field>\n\n          <Field label=\"CÃ³digo / SKU\">\n            <input\n              name=\"sku\"\n              value={form.sku}\n              onChange={handleChange}\n              className=\"input-soft\"\n              placeholder=\"Ej: ENG-100\"\n            />\n          </Field>\n\n          <Field label=\"Fecha de vencimiento\">\n            <input\n              type=\"date\"\n              name=\"expiresAt\"\n              value={form.expiresAt}\n              onChange={handleChange}\n              className=\"input-soft\"\n            />\n          </Field>\n\n          <div className=\"grid grid-cols-3 gap-3\">\n            <Field label=\"CategorÃ­a\">\n              <select\n                name=\"category\"\n                value={form.category}\n                onChange={handleChange}\n                className=\"input-soft\"\n              >\n                {categories.map((c) => (\n                  <option key={c}>{c}</option>\n                ))}\n              </select>\n            </Field>\n\n            <Field label=\"Bodega\">\n              <select\n                name=\"branch\"\n                value={form.branchId}\n                onChange={(e) => {\n                  const selectedBranch = branches.find(b => b.id === e.target.value);\n                  setForm(prev => ({\n                    ...prev,\n                    branch: selectedBranch?.name || \"\",\n                    branchId: e.target.value,\n                  }));\n                }}\n                className=\"input-soft\"\n              >\n                <option value=\"\">Seleccionar...</option>\n                {branches.map((b) => (\n                  <option key={b.id} value={b.id}>{b.name}</option>\n                ))}\n              </select>\n            </Field>\n\n            <Field label=\"Unidad\">\n              <select\n                name=\"unit\"\n                value={form.unit}\n                onChange={handleChange}\n                className=\"input-soft\"\n              >\n                <option value=\"LB\">LB</option>\n                <option value=\"KG\">KG</option>\n                <option value=\"UND\">UND</option>\n              </select>\n            </Field>\n          </div>\n\n          <div className=\"grid grid-cols-4 gap-3\">\n            <NumberField label=\"Peso (lb/kg)\" name=\"unitWeight\" value={form.unitWeight} onChange={handleChange} />\n            <NumberField label=\"Stock Min\" name=\"minStock\" value={form.minStock} onChange={handleChange} />\n            <NumberField label=\"Costo\" name=\"cost\" value={form.cost} onChange={handleChange} />\n            <NumberField label=\"Precio\" name=\"price\" value={form.price} onChange={handleChange} />\n          </div>\n\n          <div className=\"flex justify-end gap-2 pt-2\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"px-4 py-2 text-xs bg-slate-200 rounded-lg hover:bg-slate-300\"\n            >\n              Cancelar\n            </button>\n\n            <button\n              type=\"submit\"\n              className=\"px-4 py-2 text-xs bg-blue-600 text-white rounded-lg hover:bg-blue-700\"\n            >\n              Guardar\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n\nfunction Field({ label, children }) {\n  return (\n    <div>\n      <label className=\"block text-[11px] font-semibold text-slate-600 mb-1\">\n        {label}\n      </label>\n      {children}\n    </div>\n  );\n}\n\nfunction NumberField(props) {\n  return (\n    <Field label={props.label}>\n      <input type=\"number\" {...props} className=\"input-soft\" />\n    </Field>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1451, "column": 0}, "map": {"version":3,"sources":["file:///Users/percyscastillo/Desktop/proyectos%20coding/agro-erp-production-2/src/modules/inventory/components/InventoryEntryModal.jsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState, useEffect } from \"react\";\n\nexport default function InventoryEntryModal({\n  isOpen,\n  onClose,\n  product,\n  onSubmit,\n}) {\n  const [qty, setQty] = useState(\"\");\n  const [cost, setCost] = useState(\"\");\n  const [expiresAt, setExpiresAt] = useState(\"\");\n  const [lot, setLot] = useState(\"\");\n  const [note, setNote] = useState(\"\");\n\n  useEffect(() => {\n    if (product) {\n      setQty(\"\");\n      setCost(product.cost ? String(product.cost) : \"\");\n      setExpiresAt(product.expiresAt ?? \"\");\n      setLot(product.lot ?? \"\");\n      setNote(\"\");\n    }\n  }, [product]);\n\n  if (!isOpen || !product) return null;\n\n  const handleSave = () => {\n    const numericQty = Number(qty);\n    if (!qty || isNaN(numericQty) || numericQty <= 0) {\n      alert(\"Ingrese una cantidad vÃ¡lida mayor a 0\");\n      return;\n    }\n\n    onSubmit({\n      productId: product.productId || product.id,\n      qty: numericQty,\n      cost: cost ? Number(cost) : product.cost,\n      expiresAt,\n      lot,\n      note,\n    });\n\n    onClose();\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black/40 flex items-center justify-center z-50\">\n      <div className=\"bg-white w-full max-w-md rounded-xl p-5 shadow-lg\">\n        <h2 className=\"text-lg font-semibold text-slate-800 mb-3\">\n          Entrada de inventario â€” {product.name}\n        </h2>\n\n        <p className=\"text-xs text-slate-500 mb-4\">\n          Sucursal: <span className=\"font-medium\">{product.branch}</span>\n        </p>\n\n        <div className=\"space-y-4 text-sm\">\n          <div>\n            <label className=\"block text-slate-600 font-medium mb-1\">\n              Cantidad a ingresar\n            </label>\n            <input\n              type=\"number\"\n              value={qty}\n              onChange={(e) => setQty(e.target.value)}\n              className=\"w-full border rounded px-3 py-2 text-sm\"\n              placeholder=\"Ej: 100\"\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-slate-600 font-medium mb-1\">\n              Costo unitario (opcional)\n            </label>\n            <input\n              type=\"number\"\n              value={cost}\n              onChange={(e) => setCost(e.target.value)}\n              className=\"w-full border rounded px-3 py-2 text-sm\"\n              placeholder=\"Ej: 25.50\"\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-slate-600 font-medium mb-1\">\n              Fecha de vencimiento (opcional)\n            </label>\n            <input\n              type=\"date\"\n              value={expiresAt}\n              onChange={(e) => setExpiresAt(e.target.value)}\n              className=\"w-full border rounded px-3 py-2 text-sm\"\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-slate-600 font-medium mb-1\">\n              Lote (opcional)\n            </label>\n            <input\n              type=\"text\"\n              value={lot}\n              onChange={(e) => setLot(e.target.value)}\n              className=\"w-full border rounded px-3 py-2 text-sm\"\n              placeholder=\"Ej: LOTE-2024-001\"\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-slate-600 font-medium mb-1\">\n              Nota (opcional)\n            </label>\n            <textarea\n              value={note}\n              onChange={(e) => setNote(e.target.value)}\n              rows={2}\n              className=\"w-full border rounded px-3 py-2 text-sm\"\n              placeholder=\"Ej: compra nueva, ajuste, proveedor X\"\n            />\n          </div>\n        </div>\n\n        <div className=\"flex justify-end gap-2 mt-5\">\n          <button\n            onClick={onClose}\n            className=\"px-3 py-2 bg-slate-200 rounded text-xs hover:bg-slate-300\"\n          >\n            Cancelar\n          </button>\n\n          <button\n            onClick={handleSave}\n            className=\"px-3 py-2 bg-emerald-600 text-white rounded text-xs hover:bg-emerald-700\"\n          >\n            Guardar entrada\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAIe,SAAS,oBAAoB,EAC1C,MAAM,EACN,OAAO,EACP,OAAO,EACP,QAAQ,EACT;IACC,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,mRAAQ,EAAC;IAC/B,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,mRAAQ,EAAC;IACjC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,mRAAQ,EAAC;IAC3C,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,mRAAQ,EAAC;IAC/B,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,mRAAQ,EAAC;IAEjC,IAAA,oRAAS,EAAC;QACR,IAAI,SAAS;YACX,OAAO;YACP,QAAQ,QAAQ,IAAI,GAAG,OAAO,QAAQ,IAAI,IAAI;YAC9C,aAAa,QAAQ,SAAS,IAAI;YAClC,OAAO,QAAQ,GAAG,IAAI;YACtB,QAAQ;QACV;IACF,GAAG;QAAC;KAAQ;IAEZ,IAAI,CAAC,UAAU,CAAC,SAAS,OAAO;IAEhC,MAAM,aAAa;QACjB,MAAM,aAAa,OAAO;QAC1B,IAAI,CAAC,OAAO,MAAM,eAAe,cAAc,GAAG;YAChD,MAAM;YACN;QACF;QAEA,SAAS;YACP,WAAW,QAAQ,SAAS,IAAI,QAAQ,EAAE;YAC1C,KAAK;YACL,MAAM,OAAO,OAAO,QAAQ,QAAQ,IAAI;YACxC;YACA;YACA;QACF;QAEA;IACF;IAEA,qBACE,gTAAC;QAAI,WAAU;kBACb,cAAA,gTAAC;YAAI,WAAU;;8BACb,gTAAC;oBAAG,WAAU;;wBAA4C;wBAC/B,QAAQ,IAAI;;;;;;;8BAGvC,gTAAC;oBAAE,WAAU;;wBAA8B;sCAC/B,gTAAC;4BAAK,WAAU;sCAAe,QAAQ,MAAM;;;;;;;;;;;;8BAGzD,gTAAC;oBAAI,WAAU;;sCACb,gTAAC;;8CACC,gTAAC;oCAAM,WAAU;8CAAwC;;;;;;8CAGzD,gTAAC;oCACC,MAAK;oCACL,OAAO;oCACP,UAAU,CAAC,IAAM,OAAO,EAAE,MAAM,CAAC,KAAK;oCACtC,WAAU;oCACV,aAAY;;;;;;;;;;;;sCAIhB,gTAAC;;8CACC,gTAAC;oCAAM,WAAU;8CAAwC;;;;;;8CAGzD,gTAAC;oCACC,MAAK;oCACL,OAAO;oCACP,UAAU,CAAC,IAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;oCACvC,WAAU;oCACV,aAAY;;;;;;;;;;;;sCAIhB,gTAAC;;8CACC,gTAAC;oCAAM,WAAU;8CAAwC;;;;;;8CAGzD,gTAAC;oCACC,MAAK;oCACL,OAAO;oCACP,UAAU,CAAC,IAAM,aAAa,EAAE,MAAM,CAAC,KAAK;oCAC5C,WAAU;;;;;;;;;;;;sCAId,gTAAC;;8CACC,gTAAC;oCAAM,WAAU;8CAAwC;;;;;;8CAGzD,gTAAC;oCACC,MAAK;oCACL,OAAO;oCACP,UAAU,CAAC,IAAM,OAAO,EAAE,MAAM,CAAC,KAAK;oCACtC,WAAU;oCACV,aAAY;;;;;;;;;;;;sCAIhB,gTAAC;;8CACC,gTAAC;oCAAM,WAAU;8CAAwC;;;;;;8CAGzD,gTAAC;oCACC,OAAO;oCACP,UAAU,CAAC,IAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;oCACvC,MAAM;oCACN,WAAU;oCACV,aAAY;;;;;;;;;;;;;;;;;;8BAKlB,gTAAC;oBAAI,WAAU;;sCACb,gTAAC;4BACC,SAAS;4BACT,WAAU;sCACX;;;;;;sCAID,gTAAC;4BACC,SAAS;4BACT,WAAU;sCACX;;;;;;;;;;;;;;;;;;;;;;;AAOX"}},
    {"offset": {"line": 1714, "column": 0}, "map": {"version":3,"sources":["file:///Users/percyscastillo/Desktop/proyectos%20coding/agro-erp-production-2/src/modules/inventory/components/InventoryExitModal.jsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState, useEffect } from \"react\";\n\nexport default function InventoryExitModal({\n  isOpen,\n  onClose,\n  product,\n  onSubmit,\n}) {\n  const [qty, setQty] = useState(\"\");\n  const [reason, setReason] = useState(\"Ajuste\");\n  const [note, setNote] = useState(\"\");\n\n  useEffect(() => {\n    if (product) {\n      setQty(\"\");\n      setReason(\"Ajuste\");\n      setNote(\"\");\n    }\n  }, [product]);\n\n  if (!isOpen || !product) return null;\n\n  const handleSave = () => {\n    const numericQty = Number(qty);\n    if (!qty || isNaN(numericQty) || numericQty <= 0) {\n      alert(\"La cantidad debe ser mayor a 0\");\n      return;\n    }\n\n    if (numericQty > product.stock) {\n      alert(\"No puedes sacar mÃ¡s unidades de las que hay en inventario.\");\n      return;\n    }\n\n    onSubmit({\n      productId: product.productId || product.id,\n      qty: numericQty,\n      reason,\n      note,\n    });\n\n    onClose();\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black/40 flex items-center justify-center z-50\">\n      <div className=\"bg-white w-full max-w-md rounded-xl p-5 shadow-lg\">\n        <h2 className=\"text-lg font-semibold text-slate-800 mb-3\">\n          Salida de inventario â€” {product.name}\n        </h2>\n\n        <p className=\"text-xs text-slate-500 mb-4\">\n          Sucursal: <span className=\"font-medium\">{product.branch}</span>\n        </p>\n\n        <div className=\"space-y-4 text-sm\">\n          <div>\n            <label className=\"block text-slate-600 font-medium mb-1\">\n              Cantidad a descontar\n            </label>\n            <input\n              type=\"number\"\n              value={qty}\n              onChange={(e) => setQty(e.target.value)}\n              className=\"w-full border rounded px-3 py-2 text-sm\"\n              placeholder=\"Ej: 10\"\n            />\n            <p className=\"text-[11px] text-slate-500 mt-1\">\n              Stock disponible: {product.stock}\n            </p>\n          </div>\n\n          <div>\n            <label className=\"block text-slate-600 font-medium mb-1\">\n              Motivo\n            </label>\n            <select\n              value={reason}\n              onChange={(e) => setReason(e.target.value)}\n              className=\"w-full border rounded px-3 py-2 text-sm\"\n            >\n              <option>Ajuste</option>\n              <option>Merma</option>\n              <option>Vencido</option>\n              <option>DaÃ±o en almacenamiento</option>\n              <option>Robo / PÃ©rdida</option>\n              <option>Salida manual</option>\n            </select>\n          </div>\n\n          <div>\n            <label className=\"block text-slate-600 font-medium mb-1\">\n              Nota (opcional)\n            </label>\n            <textarea\n              value={note}\n              onChange={(e) => setNote(e.target.value)}\n              rows={2}\n              className=\"w-full border rounded px-3 py-2 text-sm\"\n              placeholder=\"Ej: bolsas rotas, producto en mal estado...\"\n            />\n          </div>\n        </div>\n\n        <div className=\"flex justify-end gap-2 mt-5\">\n          <button\n            onClick={onClose}\n            className=\"px-3 py-2 bg-slate-200 rounded text-xs hover:bg-slate-300\"\n          >\n            Cancelar\n          </button>\n\n          <button\n            onClick={handleSave}\n            className=\"px-3 py-2 bg-red-600 text-white rounded text-xs hover:bg-red-700\"\n          >\n            Registrar salida\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAIe,SAAS,mBAAmB,EACzC,MAAM,EACN,OAAO,EACP,OAAO,EACP,QAAQ,EACT;IACC,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,mRAAQ,EAAC;IAC/B,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,mRAAQ,EAAC;IACrC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,mRAAQ,EAAC;IAEjC,IAAA,oRAAS,EAAC;QACR,IAAI,SAAS;YACX,OAAO;YACP,UAAU;YACV,QAAQ;QACV;IACF,GAAG;QAAC;KAAQ;IAEZ,IAAI,CAAC,UAAU,CAAC,SAAS,OAAO;IAEhC,MAAM,aAAa;QACjB,MAAM,aAAa,OAAO;QAC1B,IAAI,CAAC,OAAO,MAAM,eAAe,cAAc,GAAG;YAChD,MAAM;YACN;QACF;QAEA,IAAI,aAAa,QAAQ,KAAK,EAAE;YAC9B,MAAM;YACN;QACF;QAEA,SAAS;YACP,WAAW,QAAQ,SAAS,IAAI,QAAQ,EAAE;YAC1C,KAAK;YACL;YACA;QACF;QAEA;IACF;IAEA,qBACE,gTAAC;QAAI,WAAU;kBACb,cAAA,gTAAC;YAAI,WAAU;;8BACb,gTAAC;oBAAG,WAAU;;wBAA4C;wBAChC,QAAQ,IAAI;;;;;;;8BAGtC,gTAAC;oBAAE,WAAU;;wBAA8B;sCAC/B,gTAAC;4BAAK,WAAU;sCAAe,QAAQ,MAAM;;;;;;;;;;;;8BAGzD,gTAAC;oBAAI,WAAU;;sCACb,gTAAC;;8CACC,gTAAC;oCAAM,WAAU;8CAAwC;;;;;;8CAGzD,gTAAC;oCACC,MAAK;oCACL,OAAO;oCACP,UAAU,CAAC,IAAM,OAAO,EAAE,MAAM,CAAC,KAAK;oCACtC,WAAU;oCACV,aAAY;;;;;;8CAEd,gTAAC;oCAAE,WAAU;;wCAAkC;wCAC1B,QAAQ,KAAK;;;;;;;;;;;;;sCAIpC,gTAAC;;8CACC,gTAAC;oCAAM,WAAU;8CAAwC;;;;;;8CAGzD,gTAAC;oCACC,OAAO;oCACP,UAAU,CAAC,IAAM,UAAU,EAAE,MAAM,CAAC,KAAK;oCACzC,WAAU;;sDAEV,gTAAC;sDAAO;;;;;;sDACR,gTAAC;sDAAO;;;;;;sDACR,gTAAC;sDAAO;;;;;;sDACR,gTAAC;sDAAO;;;;;;sDACR,gTAAC;sDAAO;;;;;;sDACR,gTAAC;sDAAO;;;;;;;;;;;;;;;;;;sCAIZ,gTAAC;;8CACC,gTAAC;oCAAM,WAAU;8CAAwC;;;;;;8CAGzD,gTAAC;oCACC,OAAO;oCACP,UAAU,CAAC,IAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;oCACvC,MAAM;oCACN,WAAU;oCACV,aAAY;;;;;;;;;;;;;;;;;;8BAKlB,gTAAC;oBAAI,WAAU;;sCACb,gTAAC;4BACC,SAAS;4BACT,WAAU;sCACX;;;;;;sCAID,gTAAC;4BACC,SAAS;4BACT,WAAU;sCACX;;;;;;;;;;;;;;;;;;;;;;;AAOX"}},
    {"offset": {"line": 1975, "column": 0}, "map": {"version":3,"sources":["file:///Users/percyscastillo/Desktop/proyectos%20coding/agro-erp-production-2/src/modules/inventory/components/InventoryTransferModal.jsx"],"sourcesContent":["\"use client\";\n\nimport React, { useEffect, useState } from \"react\";\n\nexport default function InventoryTransferModal({\n  isOpen,\n  onClose,\n  product,\n  onSubmit,\n  branches = [],\n}) {\n  const [qty, setQty] = useState(\"\");\n  const [from, setFrom] = useState(\"\");\n  const [to, setTo] = useState(\"\");\n  const [fromBranchId, setFromBranchId] = useState(\"\");\n  const [toBranchId, setToBranchId] = useState(\"\");\n\n  useEffect(() => {\n    if (product) {\n      setQty(\"\");\n      setFrom(product.branch);\n      setFromBranchId(product.branchId || \"\");\n      setTo(\"\");\n      setToBranchId(\"\");\n    }\n  }, [product]);\n\n  if (!isOpen || !product) return null;\n\n  const handleSubmit = () => {\n    const numericQty = Number(qty);\n    if (!qty || isNaN(numericQty) || numericQty <= 0) return alert(\"La cantidad debe ser mayor a 0.\");\n    if (numericQty > product.stock) return alert(\"No hay suficiente stock disponible.\");\n    if (!to) return alert(\"Selecciona una bodega destino.\");\n    if (from === to) return alert(\"La bodega destino debe ser diferente a la origen.\");\n\n    onSubmit({\n      productId: product.productId || product.id,\n      qty: numericQty,\n      from,\n      to,\n      fromBranchId,\n      toBranchId,\n    });\n\n    onClose();\n  };\n\n  const handleToChange = (e) => {\n    const selectedName = e.target.value;\n    setTo(selectedName);\n    const branch = branches.find(b => b.name === selectedName);\n    setToBranchId(branch?.id || \"\");\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black/40 flex items-center justify-center z-50\">\n      <div className=\"bg-white rounded-xl p-5 w-[380px] space-y-4 shadow-xl\">\n\n        <h2 className=\"text-lg font-semibold text-slate-800\">\n          Traslado de inventario\n        </h2>\n\n        <p className=\"text-sm text-slate-600\">\n          Producto: <span className=\"font-semibold\">{product.name}</span>\n        </p>\n\n        {/* Cantidad */}\n        <div className=\"space-y-1\">\n          <label className=\"text-xs font-medium text-slate-600\">\n            Cantidad a trasladar\n          </label>\n          <input\n            type=\"number\"\n            value={qty}\n            onChange={(e) => setQty(e.target.value)}\n            className=\"w-full border rounded px-3 py-2 text-sm\"\n            placeholder=\"Ej: 10\"\n          />\n        </div>\n\n        {/* Origen */}\n        <div className=\"space-y-1\">\n          <label className=\"text-xs font-medium text-slate-600\">\n            Bodega origen\n          </label>\n          <input\n            type=\"text\"\n            value={from}\n            readOnly\n            className=\"w-full border rounded px-3 py-2 text-sm bg-slate-100\"\n          />\n        </div>\n\n        {/* Destino */}\n        <div className=\"space-y-1\">\n          <label className=\"text-xs font-medium text-slate-600\">\n            Bodega destino\n          </label>\n          <select\n            value={to}\n            onChange={handleToChange}\n            className=\"w-full border rounded px-3 py-2 text-sm bg-white\"\n          >\n            <option value=\"\">Seleccionar...</option>\n            {branches.filter((b) => b.name !== from).map((b) => (\n              <option key={b.id} value={b.name}>\n                {b.name}\n              </option>\n            ))}\n          </select>\n        </div>\n\n        {/* Botones */}\n        <div className=\"flex justify-end gap-2 pt-2\">\n          <button\n            onClick={onClose}\n            className=\"px-3 py-1.5 text-sm bg-slate-200 rounded hover:bg-slate-300\"\n          >\n            Cancelar\n          </button>\n          <button\n            onClick={handleSubmit}\n            className=\"px-3 py-1.5 text-sm bg-blue-600 text-white rounded hover:bg-blue-700\"\n          >\n            Transferir\n          </button>\n        </div>\n\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAIe,SAAS,uBAAuB,EAC7C,MAAM,EACN,OAAO,EACP,OAAO,EACP,QAAQ,EACR,WAAW,EAAE,EACd;IACC,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,mRAAQ,EAAC;IAC/B,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,mRAAQ,EAAC;IACjC,MAAM,CAAC,IAAI,MAAM,GAAG,IAAA,mRAAQ,EAAC;IAC7B,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,mRAAQ,EAAC;IACjD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,mRAAQ,EAAC;IAE7C,IAAA,oRAAS,EAAC;QACR,IAAI,SAAS;YACX,OAAO;YACP,QAAQ,QAAQ,MAAM;YACtB,gBAAgB,QAAQ,QAAQ,IAAI;YACpC,MAAM;YACN,cAAc;QAChB;IACF,GAAG;QAAC;KAAQ;IAEZ,IAAI,CAAC,UAAU,CAAC,SAAS,OAAO;IAEhC,MAAM,eAAe;QACnB,MAAM,aAAa,OAAO;QAC1B,IAAI,CAAC,OAAO,MAAM,eAAe,cAAc,GAAG,OAAO,MAAM;QAC/D,IAAI,aAAa,QAAQ,KAAK,EAAE,OAAO,MAAM;QAC7C,IAAI,CAAC,IAAI,OAAO,MAAM;QACtB,IAAI,SAAS,IAAI,OAAO,MAAM;QAE9B,SAAS;YACP,WAAW,QAAQ,SAAS,IAAI,QAAQ,EAAE;YAC1C,KAAK;YACL;YACA;YACA;YACA;QACF;QAEA;IACF;IAEA,MAAM,iBAAiB,CAAC;QACtB,MAAM,eAAe,EAAE,MAAM,CAAC,KAAK;QACnC,MAAM;QACN,MAAM,SAAS,SAAS,IAAI,CAAC,CAAA,IAAK,EAAE,IAAI,KAAK;QAC7C,cAAc,QAAQ,MAAM;IAC9B;IAEA,qBACE,gTAAC;QAAI,WAAU;kBACb,cAAA,gTAAC;YAAI,WAAU;;8BAEb,gTAAC;oBAAG,WAAU;8BAAuC;;;;;;8BAIrD,gTAAC;oBAAE,WAAU;;wBAAyB;sCAC1B,gTAAC;4BAAK,WAAU;sCAAiB,QAAQ,IAAI;;;;;;;;;;;;8BAIzD,gTAAC;oBAAI,WAAU;;sCACb,gTAAC;4BAAM,WAAU;sCAAqC;;;;;;sCAGtD,gTAAC;4BACC,MAAK;4BACL,OAAO;4BACP,UAAU,CAAC,IAAM,OAAO,EAAE,MAAM,CAAC,KAAK;4BACtC,WAAU;4BACV,aAAY;;;;;;;;;;;;8BAKhB,gTAAC;oBAAI,WAAU;;sCACb,gTAAC;4BAAM,WAAU;sCAAqC;;;;;;sCAGtD,gTAAC;4BACC,MAAK;4BACL,OAAO;4BACP,QAAQ;4BACR,WAAU;;;;;;;;;;;;8BAKd,gTAAC;oBAAI,WAAU;;sCACb,gTAAC;4BAAM,WAAU;sCAAqC;;;;;;sCAGtD,gTAAC;4BACC,OAAO;4BACP,UAAU;4BACV,WAAU;;8CAEV,gTAAC;oCAAO,OAAM;8CAAG;;;;;;gCAChB,SAAS,MAAM,CAAC,CAAC,IAAM,EAAE,IAAI,KAAK,MAAM,GAAG,CAAC,CAAC,kBAC5C,gTAAC;wCAAkB,OAAO,EAAE,IAAI;kDAC7B,EAAE,IAAI;uCADI,EAAE,EAAE;;;;;;;;;;;;;;;;;8BAQvB,gTAAC;oBAAI,WAAU;;sCACb,gTAAC;4BACC,SAAS;4BACT,WAAU;sCACX;;;;;;sCAGD,gTAAC;4BACC,SAAS;4BACT,WAAU;sCACX;;;;;;;;;;;;;;;;;;;;;;;AAQX"}},
    {"offset": {"line": 2197, "column": 0}, "map": {"version":3,"sources":["file:///Users/percyscastillo/Desktop/proyectos%20coding/agro-erp-production-2/src/modules/kardex/KardexDrawer.jsx"],"sourcesContent":["\"use client\";\n\nimport React, { useEffect, useState } from \"react\";\nimport { Line } from \"react-chartjs-2\";\nimport {\n  Chart as ChartJS,\n  LineElement,\n  PointElement,\n  CategoryScale,\n  LinearScale,\n} from \"chart.js\";\n\nChartJS.register(LineElement, PointElement, CategoryScale, LinearScale);\n\nexport default function KardexDrawer({ open, onClose, product, orgSlug }) {\n  const [loading, setLoading] = useState(false);\n  const [movements, setMovements] = useState([]);\n\n  // Obtener el ID correcto del producto (segÃºn tu BD)\n  const productId = product?.product_id ?? product?.productId ?? product?.id;\n\n  useEffect(() => {\n    if (!open || !productId) return;\n\n    async function loadKardex() {\n      setLoading(true);\n\n      try {\n        const res = await fetch(`/api/kardex`, {\n          headers: {\n            \"x-org-slug\": orgSlug,\n            \"x-product-id\": productId, // âœ”ï¸ Â¡FILTRO CORRECTO!\n          },\n        });\n\n        const json = await res.json();\n\n        if (json.success) {\n          setMovements(json.data);\n        } else {\n          console.error(\"KARDEX ERROR:\", json.error);\n        }\n      } catch (err) {\n        console.error(\"Kardex fetch error:\", err);\n      }\n\n      setLoading(false);\n    }\n\n    loadKardex();\n  }, [open, productId, orgSlug]);\n\n  // ================================\n  // DATOS PARA GRÃFICA\n  // ================================\n  const chartData = {\n    labels: movements.map((m) =>\n      m.created_at ? m.created_at.substring(0, 10) : \"Fecha\"\n    ),\n    datasets: [\n      {\n        label: \"Stock\",\n        borderColor: \"#4F46E5\",\n        borderWidth: 2,\n        tension: 0.35,\n        pointRadius: 3,\n        data: movements.map((m) => m.running_stock ?? m.qty ?? 0),\n      },\n    ],\n  };\n\n  return (\n    <div\n      className={`fixed top-0 right-0 h-full w-[420px] bg-white border-l shadow-xl transition-transform duration-300 z-50 \n      ${open ? \"translate-x-0\" : \"translate-x-full\"}`}\n    >\n      {/* HEADER */}\n      <div className=\"p-4 border-b flex items-center justify-between bg-slate-50\">\n        <div>\n          <h2 className=\"text-sm font-semibold\">Historial de Movimientos</h2>\n          <p className=\"text-xs text-slate-500\">{product?.name}</p>\n        </div>\n\n        <button\n          onClick={onClose}\n          className=\"text-slate-600 hover:text-black text-lg\"\n        >\n          âœ•\n        </button>\n      </div>\n\n      {/* CONTENIDO */}\n      <div className=\"p-4 overflow-y-auto h-full pb-10 space-y-4\">\n\n        {/* LOADING */}\n        {loading && (\n          <p className=\"text-center text-sm text-slate-500\">Cargando...</p>\n        )}\n\n        {/* SIN MOVIMIENTOS */}\n        {!loading && movements.length === 0 && (\n          <p className=\"text-center text-sm text-slate-400\">\n            No hay movimientos registrados.\n          </p>\n        )}\n\n        {/* GRÃFICA */}\n        {!loading && movements.length > 0 && (\n          <div className=\"bg-white border rounded-lg p-3 shadow-sm\">\n            <h3 className=\"text-xs font-semibold mb-2 text-slate-700\">\n              EvoluciÃ³n del stock\n            </h3>\n            <div className=\"h-36\">\n              <Line data={chartData} />\n            </div>\n          </div>\n        )}\n\n        {/* LISTA DE MOVIMIENTOS */}\n        {!loading && movements.length > 0 && (\n          <div className=\"space-y-3\">\n            {movements.map((m) => (\n              <div\n                key={m.id}\n                className=\"p-3 border rounded-lg bg-slate-50 shadow-sm text-[12px]\"\n              >\n                <div className=\"flex justify-between\">\n                  <p className=\"font-semibold text-slate-800\">\n                    {m.movement_type?.toUpperCase()}\n                  </p>\n                  <p className=\"text-slate-500\">\n                    {m.created_at?.substring(0, 10)}\n                  </p>\n                </div>\n\n                <p className=\"text-slate-700 mt-1\">\n                  Cantidad: <strong>{m.qty}</strong>\n                </p>\n\n                {m.running_stock !== null && (\n                  <p className=\"text-slate-600 text-[11px]\">\n                    Stock restante: {m.running_stock}\n                  </p>\n                )}\n\n                {m.reference && (\n                  <p className=\"mt-1 text-slate-500\">\n                    Ref: {m.reference}\n                  </p>\n                )}\n\n                {m.notes && (\n                  <p className=\"mt-1 text-slate-500\">\n                    Nota: {m.notes}\n                  </p>\n                )}\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2464, "column": 0}, "map": {"version":3,"sources":["file:///Users/percyscastillo/Desktop/proyectos%20coding/agro-erp-production-2/src/modules/inventory/inventoryScreen.jsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState } from \"react\";\nimport { useInventory } from \"./hooks/useInventory\";\n\nimport InventoryFilters from \"./components/InventoryFilters\";\nimport InventoryGrid from \"./components/InventoryGrid\";\nimport ProductFormModal from \"./components/ProductFormModal\";\nimport InventoryEntryModal from \"./components/InventoryEntryModal\";\nimport InventoryExitModal from \"./components/InventoryExitModal\";\nimport InventoryTransferModal from \"./components/InventoryTransferModal\";\n\nimport KardexDrawer from \"../kardex/KardexDrawer\";\n\nexport default function InventoryScreen({ orgSlug }) {\n  const inv = useInventory(orgSlug);\n\n  /* ============ KARDEX DRAWER ============ */\n  const [kardexOpen, setKardexOpen] = useState(false);\n  const [kardexProduct, setKardexProduct] = useState(null);\n\n  const openKardex = (product) => {\n    setKardexProduct(product);\n    setKardexOpen(true);\n  };\n\n  /* ============ ENTRADA ============ */\n  const [entryOpen, setEntryOpen] = useState(false);\n  const [entryProduct, setEntryProduct] = useState(null);\n\n  const openEntry = (product) => {\n    setEntryProduct(product);\n    setEntryOpen(true);\n  };\n\n  const handleEntrySubmit = async (data) => {\n    try {\n      const res = await fetch(\"/api/inventory/movements\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"x-org-slug\": orgSlug,\n        },\n        body: JSON.stringify({\n          productId: entryProduct.product_id ?? entryProduct.productId,\n          branchId: entryProduct.branchId,\n          type: \"entrada\",\n          qty: data.qty,\n          cost: data.cost,\n          price: entryProduct.price,\n          expiresAt: data.expiresAt,\n          lot: data.lot,\n          notes: data.note || \"Entrada manual\",\n        }),\n      });\n\n      if (!res.ok) {\n        const err = await res.json();\n        alert(err.error);\n        return;\n      }\n\n      await inv.loadInventory();\n      setEntryOpen(false);\n    } catch (err) {\n      alert(\"Error registrando entrada\");\n    }\n  };\n\n  /* ============ SALIDA ============ */\n  const [exitOpen, setExitOpen] = useState(false);\n  const [exitProduct, setExitProduct] = useState(null);\n\n  const openExit = (product) => {\n    setExitProduct(product);\n    setExitOpen(true);\n  };\n\n  const handleExitSubmit = async (data) => {\n    try {\n      const res = await fetch(\"/api/inventory/movements\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"x-org-slug\": orgSlug,\n        },\n        body: JSON.stringify({\n          productId: exitProduct.product_id ?? exitProduct.productId,\n          branchId: exitProduct.branchId,\n          type: \"salida\",\n          qty: data.qty,\n          notes: data.note || \"Salida manual\",\n        }),\n      });\n\n      if (!res.ok) {\n        const err = await res.json();\n        alert(err.error);\n        return;\n      }\n\n      await inv.loadInventory();\n      setExitOpen(false);\n    } catch (err) {\n      alert(\"Error registrando salida\");\n    }\n  };\n\n  /* ============ TRASLADO ============ */\n  const [transferOpen, setTransferOpen] = useState(false);\n  const [transferProduct, setTransferProduct] = useState(null);\n\n  const openTransfer = (product) => {\n    setTransferProduct(product);\n    setTransferOpen(true);\n  };\n\n  const handleTransferSubmit = async ({\n    productId,\n    qty,\n    fromBranchId,\n    toBranchId,\n  }) => {\n    try {\n      const res = await fetch(\"/api/inventory/movements\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"x-org-slug\": orgSlug,\n        },\n        body: JSON.stringify({\n          productId,\n          type: \"transferencia\",\n          qty,\n          from_branch: fromBranchId,\n          to_branch: toBranchId,\n          notes: \"Traslado entre sucursales\",\n        }),\n      });\n\n      if (!res.ok) {\n        const err = await res.json();\n        alert(err.error);\n        return;\n      }\n\n      await inv.loadInventory();\n      setTransferOpen(false);\n    } catch (err) {\n      alert(\"Error registrando traslado\");\n    }\n  };\n\n  /* ============ UI ============ */\n  return (\n    <div className=\"space-y-5 max-w-6xl mx-auto\">\n\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-lg font-semibold\">Inventario</h1>\n          <p className=\"text-xs text-slate-500\">\n            Control por producto, movimientos y sucursales.\n          </p>\n        </div>\n\n        <button\n          onClick={inv.openNewProduct}\n          className=\"px-3 py-2 bg-slate-900 text-white rounded-lg text-xs\"\n        >\n          + Agregar producto\n        </button>\n      </div>\n\n      <div className=\"bg-white border rounded-xl shadow-sm overflow-hidden\">\n        <div className=\"px-4 py-3 border-b\">\n          <h2 className=\"font-semibold text-sm\">Detalle de inventario</h2>\n          <p className=\"text-[11px] text-slate-500\">\n            Total filtrados: {inv.filteredProducts.length}\n          </p>\n        </div>\n\n        <div className=\"px-4 py-3 border-b\">\n          <InventoryFilters\n            search={inv.search}\n            setSearch={inv.setSearch}\n            category={inv.category}\n            setCategory={inv.setCategory}\n            branch={inv.branch}\n            setBranch={inv.setBranch}\n            lowStockOnly={inv.lowStockOnly}\n            setLowStockOnly={inv.setLowStockOnly}\n          />\n        </div>\n\n        <div className=\"px-4 py-3\">\n          <InventoryGrid\n            products={inv.filteredProducts}\n            stats={inv.stats}\n            onEdit={inv.openEditProduct}\n            onDelete={inv.deleteProduct}\n            onEntry={openEntry}\n            onExit={openExit}\n            onTransfer={openTransfer}\n            onKardex={openKardex}\n            orgSlug={orgSlug}\n          />\n        </div>\n      </div>\n\n      {/* ======= DRAWER ======= */}\n      <KardexDrawer\n        open={kardexOpen}\n        onClose={() => setKardexOpen(false)}\n        product={kardexProduct}\n        orgSlug={orgSlug}\n      />\n\n      {/* MODALES */}\n      <ProductFormModal\n        isOpen={inv.isModalOpen}\n        onClose={inv.closeModal}\n        onSave={inv.saveProduct}\n        product={inv.editingProduct}\n        categories={[\"Alimentos\", \"Medicinas\", \"Accesorios\", \"Herramientas\", \"Otros\"]}\n        branches={inv.branches}\n      />\n\n      <InventoryEntryModal\n        isOpen={entryOpen}\n        onClose={() => setEntryOpen(false)}\n        product={entryProduct}\n        onSubmit={handleEntrySubmit}\n      />\n\n      <InventoryExitModal\n        isOpen={exitOpen}\n        onClose={() => setExitOpen(false)}\n        product={exitProduct}\n        onSubmit={handleExitSubmit}\n      />\n\n      <InventoryTransferModal\n        isOpen={transferOpen}\n        onClose={() => setTransferOpen(false)}\n        product={transferProduct}\n        onSubmit={handleTransferSubmit}\n        branches={inv.branches}\n      />\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2796, "column": 0}, "map": {"version":3,"sources":["file:///Users/percyscastillo/Desktop/proyectos%20coding/agro-erp-production-2/app/%5BorgSlug%5D/inventory/page.jsx"],"sourcesContent":["\"use client\";\n\nimport { use } from \"react\";\nimport InventoryScreen from \"@/src/modules/inventory/inventoryScreen\";\n\nexport default function InventoryPage({ params }) {\n  const { orgSlug } = use(params);\n  return <InventoryScreen orgSlug={orgSlug} />;\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAKe,SAAS,cAAc,EAAE,MAAM,EAAE;IAC9C,MAAM,EAAE,OAAO,EAAE,GAAG,IAAA,8QAAG,EAAC;IACxB,qBAAO,gTAAC,4NAAe;QAAC,SAAS;;;;;;AACnC"}}]
}